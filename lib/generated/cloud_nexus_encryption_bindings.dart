// AUTO GENERATED FILE, DO NOT EDIT.
//
// Generated by `package:ffigen`.
// ignore_for_file: type=lint
import 'dart:ffi' as ffi;

/// FFI bindings for CloudNexus encryption library
class CloudNexusEncryption {
  /// Holds the symbol lookup function.
  final ffi.Pointer<T> Function<T extends ffi.NativeType>(String symbolName)
  _lookup;

  /// The symbols are looked up in [dynamicLibrary].
  CloudNexusEncryption(ffi.DynamicLibrary dynamicLibrary)
    : _lookup = dynamicLibrary.lookup;

  /// The symbols are looked up with [lookup].
  CloudNexusEncryption.fromLookup(
    ffi.Pointer<T> Function<T extends ffi.NativeType>(String symbolName) lookup,
  ) : _lookup = lookup;

  void __va_start(ffi.Pointer<va_list> arg0) {
    return ___va_start(arg0);
  }

  late final ___va_startPtr =
      _lookup<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<va_list>)>>(
        '__va_start',
      );
  late final ___va_start = ___va_startPtr
      .asFunction<void Function(ffi.Pointer<va_list>)>();

  void __security_init_cookie() {
    return ___security_init_cookie();
  }

  late final ___security_init_cookiePtr =
      _lookup<ffi.NativeFunction<ffi.Void Function()>>(
        '__security_init_cookie',
      );
  late final ___security_init_cookie = ___security_init_cookiePtr
      .asFunction<void Function()>();

  void __security_check_cookie(int _StackCookie) {
    return ___security_check_cookie(_StackCookie);
  }

  late final ___security_check_cookiePtr =
      _lookup<ffi.NativeFunction<ffi.Void Function(ffi.UintPtr)>>(
        '__security_check_cookie',
      );
  late final ___security_check_cookie = ___security_check_cookiePtr
      .asFunction<void Function(int)>();

  void __report_gsfailure(int _StackCookie) {
    return ___report_gsfailure(_StackCookie);
  }

  late final ___report_gsfailurePtr =
      _lookup<ffi.NativeFunction<ffi.Void Function(ffi.UintPtr)>>(
        '__report_gsfailure',
      );
  late final ___report_gsfailure = ___report_gsfailurePtr
      .asFunction<void Function(int)>();

  late final ffi.Pointer<ffi.UintPtr> ___security_cookie = _lookup<ffi.UintPtr>(
    '__security_cookie',
  );

  int get __security_cookie => ___security_cookie.value;

  set __security_cookie(int value) => ___security_cookie.value = value;

  void _invalid_parameter_noinfo() {
    return __invalid_parameter_noinfo();
  }

  late final __invalid_parameter_noinfoPtr =
      _lookup<ffi.NativeFunction<ffi.Void Function()>>(
        '_invalid_parameter_noinfo',
      );
  late final __invalid_parameter_noinfo = __invalid_parameter_noinfoPtr
      .asFunction<void Function()>();

  void _invalid_parameter_noinfo_noreturn() {
    return __invalid_parameter_noinfo_noreturn();
  }

  late final __invalid_parameter_noinfo_noreturnPtr =
      _lookup<ffi.NativeFunction<ffi.Void Function()>>(
        '_invalid_parameter_noinfo_noreturn',
      );
  late final __invalid_parameter_noinfo_noreturn =
      __invalid_parameter_noinfo_noreturnPtr.asFunction<void Function()>();

  void _invoke_watson(
    ffi.Pointer<ffi.WChar> _Expression,
    ffi.Pointer<ffi.WChar> _FunctionName,
    ffi.Pointer<ffi.WChar> _FileName,
    int _LineNo,
    int _Reserved,
  ) {
    return __invoke_watson(
      _Expression,
      _FunctionName,
      _FileName,
      _LineNo,
      _Reserved,
    );
  }

  late final __invoke_watsonPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(
            ffi.Pointer<ffi.WChar>,
            ffi.Pointer<ffi.WChar>,
            ffi.Pointer<ffi.WChar>,
            ffi.UnsignedInt,
            ffi.UintPtr,
          )
        >
      >('_invoke_watson');
  late final __invoke_watson = __invoke_watsonPtr
      .asFunction<
        void Function(
          ffi.Pointer<ffi.WChar>,
          ffi.Pointer<ffi.WChar>,
          ffi.Pointer<ffi.WChar>,
          int,
          int,
        )
      >();

  ffi.Pointer<ffi.Int> _errno() {
    return __errno();
  }

  late final __errnoPtr =
      _lookup<ffi.NativeFunction<ffi.Pointer<ffi.Int> Function()>>('_errno');
  late final __errno = __errnoPtr.asFunction<ffi.Pointer<ffi.Int> Function()>();

  int _set_errno(int _Value) {
    return __set_errno(_Value);
  }

  late final __set_errnoPtr =
      _lookup<ffi.NativeFunction<errno_t Function(ffi.Int)>>('_set_errno');
  late final __set_errno = __set_errnoPtr.asFunction<int Function(int)>();

  int _get_errno(ffi.Pointer<ffi.Int> _Value) {
    return __get_errno(_Value);
  }

  late final __get_errnoPtr =
      _lookup<ffi.NativeFunction<errno_t Function(ffi.Pointer<ffi.Int>)>>(
        '_get_errno',
      );
  late final __get_errno = __get_errnoPtr
      .asFunction<int Function(ffi.Pointer<ffi.Int>)>();

  int __threadid() {
    return ___threadid();
  }

  late final ___threadidPtr =
      _lookup<ffi.NativeFunction<ffi.UnsignedLong Function()>>('__threadid');
  late final ___threadid = ___threadidPtr.asFunction<int Function()>();

  int __threadhandle() {
    return ___threadhandle();
  }

  late final ___threadhandlePtr =
      _lookup<ffi.NativeFunction<ffi.UintPtr Function()>>('__threadhandle');
  late final ___threadhandle = ___threadhandlePtr.asFunction<int Function()>();

  /// Encrypt data with AES-256-GCM
  ///
  /// @param data Pointer to data to encrypt
  /// @param data_len Length of data
  /// @param key Pointer to 32-byte encryption key
  /// @param key_len Length of key (must be 32)
  /// @param output_len Pointer to store output length
  /// @return Pointer to encrypted data (caller must free with free_buffer)
  ///
  /// Output format: [nonce 12 bytes] + [ciphertext] + [mac 16 bytes]
  ffi.Pointer<ffi.Uint8> encrypt_data(
    ffi.Pointer<ffi.Uint8> data,
    int data_len,
    ffi.Pointer<ffi.Uint8> key,
    int key_len,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _encrypt_data(data, data_len, key, key_len, output_len);
  }

  late final _encrypt_dataPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Uint8> Function(
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('encrypt_data');
  late final _encrypt_data = _encrypt_dataPtr
      .asFunction<
        ffi.Pointer<ffi.Uint8> Function(
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Decrypt data with AES-256-GCM
  ///
  /// @param encrypted_data Pointer to encrypted data
  /// @param encrypted_len Length of encrypted data
  /// @param key Pointer to 32-byte decryption key
  /// @param key_len Length of key (must be 32)
  /// @param output_len Pointer to store output length
  /// @return Pointer to decrypted data (caller must free with free_buffer)
  ffi.Pointer<ffi.Uint8> decrypt_data(
    ffi.Pointer<ffi.Uint8> encrypted_data,
    int encrypted_len,
    ffi.Pointer<ffi.Uint8> key,
    int key_len,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _decrypt_data(
      encrypted_data,
      encrypted_len,
      key,
      key_len,
      output_len,
    );
  }

  late final _decrypt_dataPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Uint8> Function(
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('decrypt_data');
  late final _decrypt_data = _decrypt_dataPtr
      .asFunction<
        ffi.Pointer<ffi.Uint8> Function(
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Encrypt file with embedded FEK (Approach 1)
  ///
  /// @param file_data Pointer to file data to encrypt
  /// @param file_len Length of file data
  /// @param fek Pointer to 32-byte File Encryption Key
  /// @param fek_len Length of FEK (must be 32)
  /// @param master_key Pointer to 32-byte Master Key
  /// @param master_key_len Length of master key (must be 32)
  /// @param output_len Pointer to store output length
  /// @return Pointer to encrypted file data (caller must free with free_buffer)
  ///
  /// Format: [Header 60 bytes] + [Encrypted Data] + [MAC 16 bytes]
  /// Header: [Magic 4 bytes] + [Version 1 byte] + [Reserved 3 bytes] + [FEK Length 4 bytes] + [Wrapped FEK] + [Nonce 12 bytes]
  ffi.Pointer<ffi.Uint8> encrypt_file_with_fek(
    ffi.Pointer<ffi.Uint8> file_data,
    int file_len,
    ffi.Pointer<ffi.Uint8> fek,
    int fek_len,
    ffi.Pointer<ffi.Uint8> master_key,
    int master_key_len,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _encrypt_file_with_fek(
      file_data,
      file_len,
      fek,
      fek_len,
      master_key,
      master_key_len,
      output_len,
    );
  }

  late final _encrypt_file_with_fekPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Uint8> Function(
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('encrypt_file_with_fek');
  late final _encrypt_file_with_fek = _encrypt_file_with_fekPtr
      .asFunction<
        ffi.Pointer<ffi.Uint8> Function(
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Decrypt file with embedded FEK (Approach 1)
  ///
  /// @param encrypted_data Pointer to encrypted file data
  /// @param encrypted_len Length of encrypted data
  /// @param master_key Pointer to 32-byte Master Key
  /// @param master_key_len Length of master key (must be 32)
  /// @param output_len Pointer to store output length
  /// @return Pointer to decrypted file data (caller must free with free_buffer)
  ffi.Pointer<ffi.Uint8> decrypt_file_with_fek(
    ffi.Pointer<ffi.Uint8> encrypted_data,
    int encrypted_len,
    ffi.Pointer<ffi.Uint8> master_key,
    int master_key_len,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _decrypt_file_with_fek(
      encrypted_data,
      encrypted_len,
      master_key,
      master_key_len,
      output_len,
    );
  }

  late final _decrypt_file_with_fekPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Uint8> Function(
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('decrypt_file_with_fek');
  late final _decrypt_file_with_fek = _decrypt_file_with_fekPtr
      .asFunction<
        ffi.Pointer<ffi.Uint8> Function(
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Encrypt file using streaming encryption (Option 2)
  ///
  /// @param file_data Pointer to file data to encrypt
  /// @param file_len Length of file data
  /// @param master_key Pointer to 32-byte Master Key
  /// @param master_key_len Length of master key (must be 32)
  /// @param output_len Pointer to store output length
  /// @param progress_callback Optional progress callback (can be NULL)
  /// @param user_data User data to pass to progress callback
  /// @return Pointer to encrypted file data (caller must free with free_buffer)
  ///
  /// Format:
  /// [Main Header 12 bytes: magic 4 + version 1 + reserved 3 + fek_len 4] +
  /// [Wrapped FEK] +
  /// [Chunk Header 36 bytes] + [Chunk Data] +
  /// [Chunk Header 36 bytes] + [Chunk Data] + ...
  ///
  /// Chunk Header: [index 4] + [size 4] + [nonce 12] + [mac 16]
  ffi.Pointer<ffi.Uint8> encrypt_file_streaming(
    ffi.Pointer<ffi.Uint8> file_data,
    int file_len,
    ffi.Pointer<ffi.Uint8> master_key,
    int master_key_len,
    ffi.Pointer<ffi.Size> output_len,
    ProgressCallback progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _encrypt_file_streaming(
      file_data,
      file_len,
      master_key,
      master_key_len,
      output_len,
      progress_callback,
      user_data,
    );
  }

  late final _encrypt_file_streamingPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Uint8> Function(
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Size>,
            ProgressCallback,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('encrypt_file_streaming');
  late final _encrypt_file_streaming = _encrypt_file_streamingPtr
      .asFunction<
        ffi.Pointer<ffi.Uint8> Function(
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Size>,
          ProgressCallback,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Decrypt file encrypted with streaming encryption (Option 2)
  ///
  /// @param encrypted_data Pointer to encrypted file data
  /// @param encrypted_len Length of encrypted data
  /// @param master_key Pointer to 32-byte Master Key
  /// @param master_key_len Length of master key (must be 32)
  /// @param output_len Pointer to store output length
  /// @param progress_callback Optional progress callback (can be NULL)
  /// @param user_data User data to pass to progress callback
  /// @return Pointer to decrypted file data (caller must free with free_buffer)
  ffi.Pointer<ffi.Uint8> decrypt_file_streaming(
    ffi.Pointer<ffi.Uint8> encrypted_data,
    int encrypted_len,
    ffi.Pointer<ffi.Uint8> master_key,
    int master_key_len,
    ffi.Pointer<ffi.Size> output_len,
    ProgressCallback progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _decrypt_file_streaming(
      encrypted_data,
      encrypted_len,
      master_key,
      master_key_len,
      output_len,
      progress_callback,
      user_data,
    );
  }

  late final _decrypt_file_streamingPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Uint8> Function(
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Size>,
            ProgressCallback,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('decrypt_file_streaming');
  late final _decrypt_file_streaming = _decrypt_file_streamingPtr
      .asFunction<
        ffi.Pointer<ffi.Uint8> Function(
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Size>,
          ProgressCallback,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Simple wrapper for encrypting a file (backward compatible)
  /// Uses streaming encryption internally
  ///
  /// @param file_data Pointer to file data to encrypt
  /// @param file_len Length of file data
  /// @param master_key Pointer to 32-byte Master Key
  /// @param master_key_len Length of master key (must be 32)
  /// @param output_len Pointer to store output length
  /// @return Pointer to encrypted file data (caller must free with free_buffer)
  ffi.Pointer<ffi.Uint8> encrypt_file(
    ffi.Pointer<ffi.Uint8> file_data,
    int file_len,
    ffi.Pointer<ffi.Uint8> master_key,
    int master_key_len,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _encrypt_file(
      file_data,
      file_len,
      master_key,
      master_key_len,
      output_len,
    );
  }

  late final _encrypt_filePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Uint8> Function(
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('encrypt_file');
  late final _encrypt_file = _encrypt_filePtr
      .asFunction<
        ffi.Pointer<ffi.Uint8> Function(
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Simple wrapper for decrypting a file (backward compatible)
  /// Uses streaming decryption internally
  ///
  /// @param encrypted_data Pointer to encrypted file data
  /// @param encrypted_len Length of encrypted data
  /// @param master_key Pointer to 32-byte Master Key
  /// @param master_key_len Length of master key (must be 32)
  /// @param output_len Pointer to store output length
  /// @return Pointer to decrypted file data (caller must free with free_buffer)
  ffi.Pointer<ffi.Uint8> decrypt_file(
    ffi.Pointer<ffi.Uint8> encrypted_data,
    int encrypted_len,
    ffi.Pointer<ffi.Uint8> master_key,
    int master_key_len,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _decrypt_file(
      encrypted_data,
      encrypted_len,
      master_key,
      master_key_len,
      output_len,
    );
  }

  late final _decrypt_filePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Uint8> Function(
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('decrypt_file');
  late final _decrypt_file = _decrypt_filePtr
      .asFunction<
        ffi.Pointer<ffi.Uint8> Function(
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Derive key from password using PBKDF2-HMAC-SHA256
  ///
  /// @param password Password string (null-terminated)
  /// @param salt Pointer to salt
  /// @param salt_len Length of salt
  /// @param iterations Number of PBKDF2 iterations
  /// @param output_key Pointer to store derived key (32 bytes)
  /// @return 0 on success, error code on failure
  int derive_key_from_password(
    ffi.Pointer<ffi.Char> password,
    ffi.Pointer<ffi.Uint8> salt,
    int salt_len,
    int iterations,
    ffi.Pointer<ffi.Uint8> output_key,
  ) {
    return _derive_key_from_password(
      password,
      salt,
      salt_len,
      iterations,
      output_key,
    );
  }

  late final _derive_key_from_passwordPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int Function(
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Uint32,
            ffi.Pointer<ffi.Uint8>,
          )
        >
      >('derive_key_from_password');
  late final _derive_key_from_password = _derive_key_from_passwordPtr
      .asFunction<
        int Function(
          ffi.Pointer<ffi.Char>,
          ffi.Pointer<ffi.Uint8>,
          int,
          int,
          ffi.Pointer<ffi.Uint8>,
        )
      >();

  /// Free memory allocated by Rust
  ///
  /// @param buffer Pointer to buffer to free
  void free_buffer(ffi.Pointer<ffi.Uint8> buffer) {
    return _free_buffer(buffer);
  }

  late final _free_bufferPtr =
      _lookup<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Uint8>)>>(
        'free_buffer',
      );
  late final _free_buffer = _free_bufferPtr
      .asFunction<void Function(ffi.Pointer<ffi.Uint8>)>();

  /// Initialize encryption context for streaming encryption
  ///
  /// This function generates a File Encryption Key (FEK) and wraps it with the master key.
  /// The returned context can be used for encrypting multiple chunks.
  ///
  /// @param master_key Pointer to 32-byte Master Key
  /// @param master_key_len Length of master key (must be 32)
  /// @param output_len Pointer to store header size (HEADER_SIZE + wrapped_fek_len)
  /// @return Pointer to EncryptionContext, or NULL on error
  ///
  /// The caller is responsible for:
  /// 1. Calling encrypt_chunk() for each chunk of data
  /// 2. Calling encrypt_file_finalize() to free the context
  ///
  /// The header bytes can be written to the output file followed by the wrapped FEK.
  ffi.Pointer<EncryptionContext> encrypt_file_init(
    ffi.Pointer<ffi.Uint8> master_key,
    int master_key_len,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _encrypt_file_init(master_key, master_key_len, output_len);
  }

  late final _encrypt_file_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<EncryptionContext> Function(
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('encrypt_file_init');
  late final _encrypt_file_init = _encrypt_file_initPtr
      .asFunction<
        ffi.Pointer<EncryptionContext> Function(
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Get the wrapped FEK bytes from encryption context
  ///
  /// This function retrieves the wrapped FEK that was generated during encrypt_file_init().
  /// The wrapped FEK must be written to the output file after the header.
  ///
  /// @param context Pointer to EncryptionContext from encrypt_file_init()
  /// @param output_len Pointer to store wrapped FEK length
  /// @return Pointer to wrapped FEK bytes (caller must free with free_buffer)
  ffi.Pointer<ffi.Uint8> encrypt_file_get_wrapped_fek(
    ffi.Pointer<EncryptionContext> context,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _encrypt_file_get_wrapped_fek(context, output_len);
  }

  late final _encrypt_file_get_wrapped_fekPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Uint8> Function(
            ffi.Pointer<EncryptionContext>,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('encrypt_file_get_wrapped_fek');
  late final _encrypt_file_get_wrapped_fek = _encrypt_file_get_wrapped_fekPtr
      .asFunction<
        ffi.Pointer<ffi.Uint8> Function(
          ffi.Pointer<EncryptionContext>,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Encrypt a single chunk of data using the encryption context
  ///
  /// This function encrypts one chunk at a time, allowing true streaming encryption
  /// with minimal memory usage.
  ///
  /// @param context Pointer to EncryptionContext from encrypt_file_init()
  /// @param chunk_data Pointer to chunk data to encrypt
  /// @param chunk_len Length of chunk data
  /// @param chunk_index Index of this chunk (must increment for each chunk)
  /// @param output_len Pointer to store output length
  /// @return Pointer to encrypted chunk (caller must free with free_buffer), or NULL on error
  ///
  /// Format of returned data: [Chunk Header 20 bytes] + [Encrypted Data]
  /// - Chunk Header: index (4) + size (4) + nonce (12)
  /// - Encrypted Data: ciphertext + MAC tag
  ffi.Pointer<ffi.Uint8> encrypt_chunk(
    ffi.Pointer<EncryptionContext> context,
    ffi.Pointer<ffi.Uint8> chunk_data,
    int chunk_len,
    int chunk_index,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _encrypt_chunk(
      context,
      chunk_data,
      chunk_len,
      chunk_index,
      output_len,
    );
  }

  late final _encrypt_chunkPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Uint8> Function(
            ffi.Pointer<EncryptionContext>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Uint32,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('encrypt_chunk');
  late final _encrypt_chunk = _encrypt_chunkPtr
      .asFunction<
        ffi.Pointer<ffi.Uint8> Function(
          ffi.Pointer<EncryptionContext>,
          ffi.Pointer<ffi.Uint8>,
          int,
          int,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Finalize encryption context and free memory
  ///
  /// @param context Pointer to EncryptionContext from encrypt_file_init()
  void encrypt_file_finalize(ffi.Pointer<EncryptionContext> context) {
    return _encrypt_file_finalize(context);
  }

  late final _encrypt_file_finalizePtr =
      _lookup<
        ffi.NativeFunction<ffi.Void Function(ffi.Pointer<EncryptionContext>)>
      >('encrypt_file_finalize');
  late final _encrypt_file_finalize = _encrypt_file_finalizePtr
      .asFunction<void Function(ffi.Pointer<EncryptionContext>)>();

  /// Initialize decryption context for streaming decryption
  ///
  /// This function parses the encrypted file header and unwraps the FEK.
  /// The returned context can be used for decrypting multiple chunks.
  ///
  /// @param encrypted_data Pointer to encrypted file data (must include header and wrapped FEK)
  /// @param encrypted_len Length of encrypted data (must be at least header + wrapped FEK)
  /// @param master_key Pointer to 32-byte Master Key
  /// @param master_key_len Length of master key (must be 32)
  /// @return Pointer to DecryptionContext, or NULL on error
  ///
  /// The caller is responsible for:
  /// 1. Calling decrypt_chunk() for each chunk of encrypted data
  /// 2. Calling decrypt_file_finalize() to free the context
  ffi.Pointer<DecryptionContext> decrypt_file_init(
    ffi.Pointer<ffi.Uint8> encrypted_data,
    int encrypted_len,
    ffi.Pointer<ffi.Uint8> master_key,
    int master_key_len,
  ) {
    return _decrypt_file_init(
      encrypted_data,
      encrypted_len,
      master_key,
      master_key_len,
    );
  }

  late final _decrypt_file_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<DecryptionContext> Function(
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
          )
        >
      >('decrypt_file_init');
  late final _decrypt_file_init = _decrypt_file_initPtr
      .asFunction<
        ffi.Pointer<DecryptionContext> Function(
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
        )
      >();

  /// Decrypt a single chunk of encrypted data using the decryption context
  ///
  /// This function decrypts one chunk at a time, allowing true streaming decryption
  /// with minimal memory usage.
  ///
  /// @param context Pointer to DecryptionContext from decrypt_file_init()
  /// @param encrypted_chunk Pointer to encrypted chunk data (must include chunk header)
  /// @param chunk_len Length of encrypted chunk data
  /// @param output_len Pointer to store output length
  /// @return Pointer to decrypted chunk (caller must free with free_buffer), or NULL on error
  ffi.Pointer<ffi.Uint8> decrypt_chunk(
    ffi.Pointer<DecryptionContext> context,
    ffi.Pointer<ffi.Uint8> encrypted_chunk,
    int chunk_len,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _decrypt_chunk(context, encrypted_chunk, chunk_len, output_len);
  }

  late final _decrypt_chunkPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Uint8> Function(
            ffi.Pointer<DecryptionContext>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('decrypt_chunk');
  late final _decrypt_chunk = _decrypt_chunkPtr
      .asFunction<
        ffi.Pointer<ffi.Uint8> Function(
          ffi.Pointer<DecryptionContext>,
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Finalize decryption context and free memory
  ///
  /// @param context Pointer to DecryptionContext from decrypt_file_init()
  void decrypt_file_finalize(ffi.Pointer<DecryptionContext> context) {
    return _decrypt_file_finalize(context);
  }

  late final _decrypt_file_finalizePtr =
      _lookup<
        ffi.NativeFunction<ffi.Void Function(ffi.Pointer<DecryptionContext>)>
      >('decrypt_file_finalize');
  late final _decrypt_file_finalize = _decrypt_file_finalizePtr
      .asFunction<void Function(ffi.Pointer<DecryptionContext>)>();

  /// Initialize a folder scan operation
  ///
  /// @param folder_path Path to the folder to scan (null-terminated)
  /// @param max_depth Maximum scan depth (0 for unlimited)
  /// @return Pointer to FolderScanContext, or NULL on error
  ///
  /// The caller is responsible for:
  /// 1. Calling scan_folder_get_json() or other getter functions
  /// 2. Calling scan_folder_free() to free the context
  ffi.Pointer<FolderScanContext> scan_folder_init(
    ffi.Pointer<ffi.Char> folder_path,
    int max_depth,
  ) {
    return _scan_folder_init(folder_path, max_depth);
  }

  late final _scan_folder_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<FolderScanContext> Function(
            ffi.Pointer<ffi.Char>,
            ffi.Uint32,
          )
        >
      >('scan_folder_init');
  late final _scan_folder_init = _scan_folder_initPtr
      .asFunction<
        ffi.Pointer<FolderScanContext> Function(ffi.Pointer<ffi.Char>, int)
      >();

  /// Get the JSON representation of scan results
  ///
  /// @param context Pointer to FolderScanContext
  /// @param output_len Pointer to store output length
  /// @return Pointer to JSON string (caller must free with scan_folder_free_string), or NULL on error
  ///
  /// JSON format:
  /// {
  /// "root_path": "C:/path/to/folder",
  /// "items": [
  /// {
  /// "relative_path": "subfolder/file.txt",
  /// "name": "file.txt",
  /// "is_folder": false,
  /// "size": 1024,
  /// "absolute_path": "C:/path/to/folder/subfolder/file.txt"
  /// }
  /// ],
  /// "total_size": 2048,
  /// "file_count": 2,
  /// "folder_count": 1,
  /// "scan_duration_ms": 15
  /// }
  ffi.Pointer<ffi.Char> scan_folder_get_json(
    ffi.Pointer<FolderScanContext> context,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _scan_folder_get_json(context, output_len);
  }

  late final _scan_folder_get_jsonPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Char> Function(
            ffi.Pointer<FolderScanContext>,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('scan_folder_get_json');
  late final _scan_folder_get_json = _scan_folder_get_jsonPtr
      .asFunction<
        ffi.Pointer<ffi.Char> Function(
          ffi.Pointer<FolderScanContext>,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Get the error message if scan failed
  ///
  /// @param context Pointer to FolderScanContext
  /// @param output_len Pointer to store output length
  /// @return Pointer to error string (caller must free with scan_folder_free_string), or NULL if no error
  ffi.Pointer<ffi.Char> scan_folder_get_error(
    ffi.Pointer<FolderScanContext> context,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _scan_folder_get_error(context, output_len);
  }

  late final _scan_folder_get_errorPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Char> Function(
            ffi.Pointer<FolderScanContext>,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('scan_folder_get_error');
  late final _scan_folder_get_error = _scan_folder_get_errorPtr
      .asFunction<
        ffi.Pointer<ffi.Char> Function(
          ffi.Pointer<FolderScanContext>,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Check if scan was successful
  ///
  /// @param context Pointer to FolderScanContext
  /// @return 1 if successful, 0 if error occurred
  int scan_folder_is_success(ffi.Pointer<FolderScanContext> context) {
    return _scan_folder_is_success(context);
  }

  late final _scan_folder_is_successPtr =
      _lookup<
        ffi.NativeFunction<ffi.Int32 Function(ffi.Pointer<FolderScanContext>)>
      >('scan_folder_is_success');
  late final _scan_folder_is_success = _scan_folder_is_successPtr
      .asFunction<int Function(ffi.Pointer<FolderScanContext>)>();

  /// Get file count from scan result
  ///
  /// @param context Pointer to FolderScanContext
  /// @return Number of files, or 0 if no result
  int scan_folder_get_file_count(ffi.Pointer<FolderScanContext> context) {
    return _scan_folder_get_file_count(context);
  }

  late final _scan_folder_get_file_countPtr =
      _lookup<
        ffi.NativeFunction<ffi.Uint64 Function(ffi.Pointer<FolderScanContext>)>
      >('scan_folder_get_file_count');
  late final _scan_folder_get_file_count = _scan_folder_get_file_countPtr
      .asFunction<int Function(ffi.Pointer<FolderScanContext>)>();

  /// Get folder count from scan result
  ///
  /// @param context Pointer to FolderScanContext
  /// @return Number of folders, or 0 if no result
  int scan_folder_get_folder_count(ffi.Pointer<FolderScanContext> context) {
    return _scan_folder_get_folder_count(context);
  }

  late final _scan_folder_get_folder_countPtr =
      _lookup<
        ffi.NativeFunction<ffi.Uint64 Function(ffi.Pointer<FolderScanContext>)>
      >('scan_folder_get_folder_count');
  late final _scan_folder_get_folder_count = _scan_folder_get_folder_countPtr
      .asFunction<int Function(ffi.Pointer<FolderScanContext>)>();

  /// Get total size from scan result
  ///
  /// @param context Pointer to FolderScanContext
  /// @return Total size in bytes, or 0 if no result
  int scan_folder_get_total_size(ffi.Pointer<FolderScanContext> context) {
    return _scan_folder_get_total_size(context);
  }

  late final _scan_folder_get_total_sizePtr =
      _lookup<
        ffi.NativeFunction<ffi.Uint64 Function(ffi.Pointer<FolderScanContext>)>
      >('scan_folder_get_total_size');
  late final _scan_folder_get_total_size = _scan_folder_get_total_sizePtr
      .asFunction<int Function(ffi.Pointer<FolderScanContext>)>();

  /// Get scan duration from scan result
  ///
  /// @param context Pointer to FolderScanContext
  /// @return Scan duration in milliseconds, or 0 if no result
  int scan_folder_get_duration_ms(ffi.Pointer<FolderScanContext> context) {
    return _scan_folder_get_duration_ms(context);
  }

  late final _scan_folder_get_duration_msPtr =
      _lookup<
        ffi.NativeFunction<ffi.Uint64 Function(ffi.Pointer<FolderScanContext>)>
      >('scan_folder_get_duration_ms');
  late final _scan_folder_get_duration_ms = _scan_folder_get_duration_msPtr
      .asFunction<int Function(ffi.Pointer<FolderScanContext>)>();

  /// Free a string allocated by scan_folder_get_json or scan_folder_get_error
  ///
  /// @param s Pointer to string to free
  void scan_folder_free_string(ffi.Pointer<ffi.Char> s) {
    return _scan_folder_free_string(s);
  }

  late final _scan_folder_free_stringPtr =
      _lookup<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ffi.Char>)>>(
        'scan_folder_free_string',
      );
  late final _scan_folder_free_string = _scan_folder_free_stringPtr
      .asFunction<void Function(ffi.Pointer<ffi.Char>)>();

  /// Free folder scan context
  ///
  /// @param context Pointer to FolderScanContext to free
  void scan_folder_free(ffi.Pointer<FolderScanContext> context) {
    return _scan_folder_free(context);
  }

  late final _scan_folder_freePtr =
      _lookup<
        ffi.NativeFunction<ffi.Void Function(ffi.Pointer<FolderScanContext>)>
      >('scan_folder_free');
  late final _scan_folder_free = _scan_folder_freePtr
      .asFunction<void Function(ffi.Pointer<FolderScanContext>)>();

  /// Quick scan function that returns JSON directly
  /// This is a convenience function for simple use cases
  ///
  /// @param folder_path Path to the folder to scan (null-terminated)
  /// @param max_depth Maximum scan depth (0 for unlimited)
  /// @param output_len Pointer to store output length
  /// @return Pointer to JSON string (caller must free with scan_folder_free_string), or NULL on error
  ffi.Pointer<ffi.Char> scan_folder_quick(
    ffi.Pointer<ffi.Char> folder_path,
    int max_depth,
    ffi.Pointer<ffi.Size> output_len,
  ) {
    return _scan_folder_quick(folder_path, max_depth, output_len);
  }

  late final _scan_folder_quickPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ffi.Char> Function(
            ffi.Pointer<ffi.Char>,
            ffi.Uint32,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('scan_folder_quick');
  late final _scan_folder_quick = _scan_folder_quickPtr
      .asFunction<
        ffi.Pointer<ffi.Char> Function(
          ffi.Pointer<ffi.Char>,
          int,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Initialize upload context
  ffi.Pointer<UploadContext> upload_init(
    ffi.Pointer<ffi.Char> local_file_path,
    ffi.Pointer<ffi.Uint8> master_key,
    int master_key_len,
    int chunk_size,
    int should_encrypt,
    UploadProgressCallback progress_callback,
    UploadDataCallback data_callback,
    ffi.Pointer<ffi.Void> cancel_flag,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _upload_init(
      local_file_path,
      master_key,
      master_key_len,
      chunk_size,
      should_encrypt,
      progress_callback,
      data_callback,
      cancel_flag,
      user_data,
    );
  }

  late final _upload_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<UploadContext> Function(
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Size,
            ffi.Int32,
            UploadProgressCallback,
            UploadDataCallback,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('upload_init');
  late final _upload_init = _upload_initPtr
      .asFunction<
        ffi.Pointer<UploadContext> Function(
          ffi.Pointer<ffi.Char>,
          ffi.Pointer<ffi.Uint8>,
          int,
          int,
          int,
          UploadProgressCallback,
          UploadDataCallback,
          ffi.Pointer<ffi.Void>,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Process next chunk of upload
  int upload_process_chunk(
    ffi.Pointer<UploadContext> context,
    ffi.Pointer<ffi.Uint8> buffer,
    int buffer_size,
    UploadProgressCallback progress_callback,
    UploadDataCallback data_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _upload_process_chunk(
      context,
      buffer,
      buffer_size,
      progress_callback,
      data_callback,
      user_data,
    );
  }

  late final _upload_process_chunkPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.IntPtr Function(
            ffi.Pointer<UploadContext>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            UploadProgressCallback,
            UploadDataCallback,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('upload_process_chunk');
  late final _upload_process_chunk = _upload_process_chunkPtr
      .asFunction<
        int Function(
          ffi.Pointer<UploadContext>,
          ffi.Pointer<ffi.Uint8>,
          int,
          UploadProgressCallback,
          UploadDataCallback,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Get header and wrapped FEK for upload
  int upload_get_header(
    ffi.Pointer<UploadContext> context,
    ffi.Pointer<ffi.Uint8> header_buffer,
    ffi.Pointer<ffi.Uint8> fek_buffer,
    int fek_buffer_size,
    ffi.Pointer<ffi.Size> fek_len,
  ) {
    return _upload_get_header(
      context,
      header_buffer,
      fek_buffer,
      fek_buffer_size,
      fek_len,
    );
  }

  late final _upload_get_headerPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<UploadContext>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('upload_get_header');
  late final _upload_get_header = _upload_get_headerPtr
      .asFunction<
        int Function(
          ffi.Pointer<UploadContext>,
          ffi.Pointer<ffi.Uint8>,
          ffi.Pointer<ffi.Uint8>,
          int,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Finalize upload and clean up resources
  int upload_finalize(ffi.Pointer<UploadContext> context) {
    return _upload_finalize(context);
  }

  late final _upload_finalizePtr =
      _lookup<
        ffi.NativeFunction<ffi.Int32 Function(ffi.Pointer<UploadContext>)>
      >('upload_finalize');
  late final _upload_finalize = _upload_finalizePtr
      .asFunction<int Function(ffi.Pointer<UploadContext>)>();

  /// Free upload context
  void upload_free(ffi.Pointer<UploadContext> context) {
    return _upload_free(context);
  }

  late final _upload_freePtr =
      _lookup<
        ffi.NativeFunction<ffi.Void Function(ffi.Pointer<UploadContext>)>
      >('upload_free');
  late final _upload_free = _upload_freePtr
      .asFunction<void Function(ffi.Pointer<UploadContext>)>();

  /// Get total bytes for upload
  int upload_get_total_bytes(ffi.Pointer<UploadContext> context) {
    return _upload_get_total_bytes(context);
  }

  late final _upload_get_total_bytesPtr =
      _lookup<
        ffi.NativeFunction<ffi.Size Function(ffi.Pointer<UploadContext>)>
      >('upload_get_total_bytes');
  late final _upload_get_total_bytes = _upload_get_total_bytesPtr
      .asFunction<int Function(ffi.Pointer<UploadContext>)>();

  /// Get bytes processed
  int upload_get_bytes_processed(ffi.Pointer<UploadContext> context) {
    return _upload_get_bytes_processed(context);
  }

  late final _upload_get_bytes_processedPtr =
      _lookup<
        ffi.NativeFunction<ffi.Size Function(ffi.Pointer<UploadContext>)>
      >('upload_get_bytes_processed');
  late final _upload_get_bytes_processed = _upload_get_bytes_processedPtr
      .asFunction<int Function(ffi.Pointer<UploadContext>)>();

  /// Copy file streaming for local copies
  int copy_file_streaming(
    ffi.Pointer<ffi.Char> source_path,
    ffi.Pointer<ffi.Char> dest_path,
    int chunk_size,
    UploadProgressCallback progress_callback,
    ffi.Pointer<ffi.Void> cancel_flag,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _copy_file_streaming(
      source_path,
      dest_path,
      chunk_size,
      progress_callback,
      cancel_flag,
      user_data,
    );
  }

  late final _copy_file_streamingPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Char>,
            ffi.Size,
            UploadProgressCallback,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('copy_file_streaming');
  late final _copy_file_streaming = _copy_file_streamingPtr
      .asFunction<
        int Function(
          ffi.Pointer<ffi.Char>,
          ffi.Pointer<ffi.Char>,
          int,
          UploadProgressCallback,
          ffi.Pointer<ffi.Void>,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Initialize download context
  ffi.Pointer<DownloadContext> download_init(
    ffi.Pointer<ffi.Char> local_file_path,
    ffi.Pointer<ffi.Uint8> master_key,
    int master_key_len,
    int should_decrypt,
    DownloadProgressCallback progress_callback,
    ffi.Pointer<ffi.Void> cancel_flag,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _download_init(
      local_file_path,
      master_key,
      master_key_len,
      should_decrypt,
      progress_callback,
      cancel_flag,
      user_data,
    );
  }

  late final _download_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<DownloadContext> Function(
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Int32,
            DownloadProgressCallback,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('download_init');
  late final _download_init = _download_initPtr
      .asFunction<
        ffi.Pointer<DownloadContext> Function(
          ffi.Pointer<ffi.Char>,
          ffi.Pointer<ffi.Uint8>,
          int,
          int,
          DownloadProgressCallback,
          ffi.Pointer<ffi.Void>,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Initialize download with known total size
  ffi.Pointer<DownloadContext> download_init_with_size(
    ffi.Pointer<ffi.Char> local_file_path,
    int total_bytes,
    ffi.Pointer<ffi.Uint8> master_key,
    int master_key_len,
    int should_decrypt,
    DownloadProgressCallback progress_callback,
    ffi.Pointer<ffi.Void> cancel_flag,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _download_init_with_size(
      local_file_path,
      total_bytes,
      master_key,
      master_key_len,
      should_decrypt,
      progress_callback,
      cancel_flag,
      user_data,
    );
  }

  late final _download_init_with_sizePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<DownloadContext> Function(
            ffi.Pointer<ffi.Char>,
            ffi.Size,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Int32,
            DownloadProgressCallback,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('download_init_with_size');
  late final _download_init_with_size = _download_init_with_sizePtr
      .asFunction<
        ffi.Pointer<DownloadContext> Function(
          ffi.Pointer<ffi.Char>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
          int,
          DownloadProgressCallback,
          ffi.Pointer<ffi.Void>,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Append encrypted chunk to download stream
  int download_append_chunk(
    ffi.Pointer<DownloadContext> context,
    ffi.Pointer<ffi.Uint8> encrypted_data,
    int data_len,
    DownloadProgressCallback progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _download_append_chunk(
      context,
      encrypted_data,
      data_len,
      progress_callback,
      user_data,
    );
  }

  late final _download_append_chunkPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<DownloadContext>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            DownloadProgressCallback,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('download_append_chunk');
  late final _download_append_chunk = _download_append_chunkPtr
      .asFunction<
        int Function(
          ffi.Pointer<DownloadContext>,
          ffi.Pointer<ffi.Uint8>,
          int,
          DownloadProgressCallback,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Append decrypted data directly
  int download_append_decrypted(
    ffi.Pointer<DownloadContext> context,
    ffi.Pointer<ffi.Uint8> data,
    int data_len,
    DownloadProgressCallback progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _download_append_decrypted(
      context,
      data,
      data_len,
      progress_callback,
      user_data,
    );
  }

  late final _download_append_decryptedPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<DownloadContext>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            DownloadProgressCallback,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('download_append_decrypted');
  late final _download_append_decrypted = _download_append_decryptedPtr
      .asFunction<
        int Function(
          ffi.Pointer<DownloadContext>,
          ffi.Pointer<ffi.Uint8>,
          int,
          DownloadProgressCallback,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Finalize download and clean up resources
  int download_finalize(ffi.Pointer<DownloadContext> context) {
    return _download_finalize(context);
  }

  late final _download_finalizePtr =
      _lookup<
        ffi.NativeFunction<ffi.Int32 Function(ffi.Pointer<DownloadContext>)>
      >('download_finalize');
  late final _download_finalize = _download_finalizePtr
      .asFunction<int Function(ffi.Pointer<DownloadContext>)>();

  /// Free download context
  void download_free(ffi.Pointer<DownloadContext> context) {
    return _download_free(context);
  }

  late final _download_freePtr =
      _lookup<
        ffi.NativeFunction<ffi.Void Function(ffi.Pointer<DownloadContext>)>
      >('download_free');
  late final _download_free = _download_freePtr
      .asFunction<void Function(ffi.Pointer<DownloadContext>)>();

  /// Get bytes written for download
  int download_get_bytes_written(ffi.Pointer<DownloadContext> context) {
    return _download_get_bytes_written(context);
  }

  late final _download_get_bytes_writtenPtr =
      _lookup<
        ffi.NativeFunction<ffi.Size Function(ffi.Pointer<DownloadContext>)>
      >('download_get_bytes_written');
  late final _download_get_bytes_written = _download_get_bytes_writtenPtr
      .asFunction<int Function(ffi.Pointer<DownloadContext>)>();

  /// Get total bytes for download
  int download_get_total_bytes(ffi.Pointer<DownloadContext> context) {
    return _download_get_total_bytes(context);
  }

  late final _download_get_total_bytesPtr =
      _lookup<
        ffi.NativeFunction<ffi.Size Function(ffi.Pointer<DownloadContext>)>
      >('download_get_total_bytes');
  late final _download_get_total_bytes = _download_get_total_bytesPtr
      .asFunction<int Function(ffi.Pointer<DownloadContext>)>();

  /// Set total bytes for download
  void download_set_total_bytes(
    ffi.Pointer<DownloadContext> context,
    int total_bytes,
  ) {
    return _download_set_total_bytes(context, total_bytes);
  }

  late final _download_set_total_bytesPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(ffi.Pointer<DownloadContext>, ffi.Size)
        >
      >('download_set_total_bytes');
  late final _download_set_total_bytes = _download_set_total_bytesPtr
      .asFunction<void Function(ffi.Pointer<DownloadContext>, int)>();

  int copy_file(
    ffi.Pointer<ffi.Char> source_path,
    ffi.Pointer<ffi.Char> dest_path,
  ) {
    return _copy_file(source_path, dest_path);
  }

  late final _copy_filePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(ffi.Pointer<ffi.Char>, ffi.Pointer<ffi.Char>)
        >
      >('copy_file');
  late final _copy_file = _copy_filePtr
      .asFunction<int Function(ffi.Pointer<ffi.Char>, ffi.Pointer<ffi.Char>)>();

  ffi.Pointer<CopyContext> folder_copy_init(
    ffi.Pointer<ffi.Char> source_path,
    ffi.Pointer<ffi.Char> dest_path,
    ffi.Pointer<ffi.Void> cancel_flag,
  ) {
    return _folder_copy_init(source_path, dest_path, cancel_flag);
  }

  late final _folder_copy_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<CopyContext> Function(
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('folder_copy_init');
  late final _folder_copy_init = _folder_copy_initPtr
      .asFunction<
        ffi.Pointer<CopyContext> Function(
          ffi.Pointer<ffi.Char>,
          ffi.Pointer<ffi.Char>,
          ffi.Pointer<ffi.Void>,
        )
      >();

  int folder_copy_next_file(
    ffi.Pointer<CopyContext> context,
    ffi.Pointer<ffi.Char> dest_path,
    int dest_path_size,
  ) {
    return _folder_copy_next_file(context, dest_path, dest_path_size);
  }

  late final _folder_copy_next_filePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<CopyContext>,
            ffi.Pointer<ffi.Char>,
            ffi.Size,
          )
        >
      >('folder_copy_next_file');
  late final _folder_copy_next_file = _folder_copy_next_filePtr
      .asFunction<
        int Function(ffi.Pointer<CopyContext>, ffi.Pointer<ffi.Char>, int)
      >();

  int folder_copy_finalize(ffi.Pointer<CopyContext> context) {
    return _folder_copy_finalize(context);
  }

  late final _folder_copy_finalizePtr =
      _lookup<ffi.NativeFunction<ffi.Int32 Function(ffi.Pointer<CopyContext>)>>(
        'folder_copy_finalize',
      );
  late final _folder_copy_finalize = _folder_copy_finalizePtr
      .asFunction<int Function(ffi.Pointer<CopyContext>)>();

  void copy_free(ffi.Pointer<CopyContext> context) {
    return _copy_free(context);
  }

  late final _copy_freePtr =
      _lookup<ffi.NativeFunction<ffi.Void Function(ffi.Pointer<CopyContext>)>>(
        'copy_free',
      );
  late final _copy_free = _copy_freePtr
      .asFunction<void Function(ffi.Pointer<CopyContext>)>();

  /// Initialize chunked streaming copy for cross-account transfers
  ///
  /// @param source_path Source file path
  /// @param dest_path Destination file path
  /// @param chunk_size Size of chunks in bytes (10MB recommended)
  /// @param cancel_flag Cancellation flag pointer
  /// @return Pointer to ChunkedCopyContext, or NULL on error
  ffi.Pointer<ChunkedCopyContext> chunked_copy_init(
    ffi.Pointer<ffi.Char> source_path,
    ffi.Pointer<ffi.Char> dest_path,
    int chunk_size,
    ffi.Pointer<ffi.Void> cancel_flag,
  ) {
    return _chunked_copy_init(source_path, dest_path, chunk_size, cancel_flag);
  }

  late final _chunked_copy_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<ChunkedCopyContext> Function(
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Char>,
            ffi.Size,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('chunked_copy_init');
  late final _chunked_copy_init = _chunked_copy_initPtr
      .asFunction<
        ffi.Pointer<ChunkedCopyContext> Function(
          ffi.Pointer<ffi.Char>,
          ffi.Pointer<ffi.Char>,
          int,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Open source file for chunked copy
  ///
  /// @param context Pointer to ChunkedCopyContext
  /// @return 0 on success, negative error code on failure
  int chunked_copy_open_source(ffi.Pointer<ChunkedCopyContext> context) {
    return _chunked_copy_open_source(context);
  }

  late final _chunked_copy_open_sourcePtr =
      _lookup<
        ffi.NativeFunction<ffi.Int32 Function(ffi.Pointer<ChunkedCopyContext>)>
      >('chunked_copy_open_source');
  late final _chunked_copy_open_source = _chunked_copy_open_sourcePtr
      .asFunction<int Function(ffi.Pointer<ChunkedCopyContext>)>();

  /// Read next chunk from source file
  ///
  /// @param context Pointer to ChunkedCopyContext
  /// @param buffer Buffer to write chunk data
  /// @param buffer_size Size of buffer
  /// @param data_callback Callback to receive chunk data (optional, can be NULL)
  /// @param user_data User data for callback
  /// @return Number of bytes read (0 for EOF), negative error code on failure
  int chunked_copy_read_chunk(
    ffi.Pointer<ChunkedCopyContext> context,
    ffi.Pointer<ffi.Uint8> buffer,
    int buffer_size,
    CopyDataCallback data_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _chunked_copy_read_chunk(
      context,
      buffer,
      buffer_size,
      data_callback,
      user_data,
    );
  }

  late final _chunked_copy_read_chunkPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.IntPtr Function(
            ffi.Pointer<ChunkedCopyContext>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            CopyDataCallback,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('chunked_copy_read_chunk');
  late final _chunked_copy_read_chunk = _chunked_copy_read_chunkPtr
      .asFunction<
        int Function(
          ffi.Pointer<ChunkedCopyContext>,
          ffi.Pointer<ffi.Uint8>,
          int,
          CopyDataCallback,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Write chunk to destination file
  ///
  /// @param context Pointer to ChunkedCopyContext
  /// @param data Pointer to data to write
  /// @param data_len Length of data
  /// @param progress_callback Optional progress callback
  /// @param user_data User data for callback
  /// @return 0 on success, negative error code on failure
  int chunked_copy_write_chunk(
    ffi.Pointer<ChunkedCopyContext> context,
    ffi.Pointer<ffi.Uint8> data,
    int data_len,
    UploadProgressCallback progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _chunked_copy_write_chunk(
      context,
      data,
      data_len,
      progress_callback,
      user_data,
    );
  }

  late final _chunked_copy_write_chunkPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<ChunkedCopyContext>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            UploadProgressCallback,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('chunked_copy_write_chunk');
  late final _chunked_copy_write_chunk = _chunked_copy_write_chunkPtr
      .asFunction<
        int Function(
          ffi.Pointer<ChunkedCopyContext>,
          ffi.Pointer<ffi.Uint8>,
          int,
          UploadProgressCallback,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Flush destination file
  ///
  /// @param context Pointer to ChunkedCopyContext
  /// @return 0 on success, negative error code on failure
  int chunked_copy_flush(ffi.Pointer<ChunkedCopyContext> context) {
    return _chunked_copy_flush(context);
  }

  late final _chunked_copy_flushPtr =
      _lookup<
        ffi.NativeFunction<ffi.Int32 Function(ffi.Pointer<ChunkedCopyContext>)>
      >('chunked_copy_flush');
  late final _chunked_copy_flush = _chunked_copy_flushPtr
      .asFunction<int Function(ffi.Pointer<ChunkedCopyContext>)>();

  /// Finalize chunked copy
  ///
  /// @param context Pointer to ChunkedCopyContext
  /// @param progress_callback Optional final progress callback
  /// @param user_data User data for callback
  /// @return 0 on success, negative error code on failure
  int chunked_copy_finalize(
    ffi.Pointer<ChunkedCopyContext> context,
    UploadProgressCallback progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _chunked_copy_finalize(context, progress_callback, user_data);
  }

  late final _chunked_copy_finalizePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<ChunkedCopyContext>,
            UploadProgressCallback,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('chunked_copy_finalize');
  late final _chunked_copy_finalize = _chunked_copy_finalizePtr
      .asFunction<
        int Function(
          ffi.Pointer<ChunkedCopyContext>,
          UploadProgressCallback,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Free chunked copy context
  ///
  /// @param context Pointer to ChunkedCopyContext
  void chunked_copy_free(ffi.Pointer<ChunkedCopyContext> context) {
    return _chunked_copy_free(context);
  }

  late final _chunked_copy_freePtr =
      _lookup<
        ffi.NativeFunction<ffi.Void Function(ffi.Pointer<ChunkedCopyContext>)>
      >('chunked_copy_free');
  late final _chunked_copy_free = _chunked_copy_freePtr
      .asFunction<void Function(ffi.Pointer<ChunkedCopyContext>)>();

  /// Get chunked copy progress
  ///
  /// @param context Pointer to ChunkedCopyContext
  /// @param bytes_copied Pointer to store bytes copied
  /// @param total_bytes Pointer to store total bytes
  void chunked_copy_get_progress(
    ffi.Pointer<ChunkedCopyContext> context,
    ffi.Pointer<ffi.Size> bytes_copied,
    ffi.Pointer<ffi.Size> total_bytes,
  ) {
    return _chunked_copy_get_progress(context, bytes_copied, total_bytes);
  }

  late final _chunked_copy_get_progressPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(
            ffi.Pointer<ChunkedCopyContext>,
            ffi.Pointer<ffi.Size>,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('chunked_copy_get_progress');
  late final _chunked_copy_get_progress = _chunked_copy_get_progressPtr
      .asFunction<
        void Function(
          ffi.Pointer<ChunkedCopyContext>,
          ffi.Pointer<ffi.Size>,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Initialize cloud-to-cloud streaming copy context
  ///
  /// Rust orchestrates the copy loop: read from source  write to destination
  ///
  /// @param chunk_size Size of chunks in bytes (10MB recommended)
  /// @param total_bytes Total bytes to transfer (0 if unknown)
  /// @param cancel_flag Cancellation flag pointer
  /// @return Pointer to CloudCopyContext, or NULL on error
  ffi.Pointer<CloudCopyContext> cloud_copy_init(
    int chunk_size,
    int total_bytes,
    ffi.Pointer<ffi.Void> cancel_flag,
  ) {
    return _cloud_copy_init(chunk_size, total_bytes, cancel_flag);
  }

  late final _cloud_copy_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<CloudCopyContext> Function(
            ffi.Size,
            ffi.Size,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('cloud_copy_init');
  late final _cloud_copy_init = _cloud_copy_initPtr
      .asFunction<
        ffi.Pointer<CloudCopyContext> Function(int, int, ffi.Pointer<ffi.Void>)
      >();

  /// Execute one chunk of cloud-to-cloud copy
  ///
  /// Rust orchestrates: read callback  write callback
  ///
  /// @param context Pointer to CloudCopyContext
  /// @param read_buffer Buffer for read operation
  /// @param buffer_size Size of read buffer
  /// @param read_callback Callback to read data from source
  /// @param write_callback Callback to write data to destination
  /// @param user_data User data for callbacks
  /// @return Number of bytes processed (0 for EOF), negative error code on failure
  int cloud_copy_process_chunk(
    ffi.Pointer<CloudCopyContext> context,
    ffi.Pointer<ffi.Uint8> read_buffer,
    int buffer_size,
    CloudCopyReadCallback read_callback,
    CloudCopyWriteCallback write_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _cloud_copy_process_chunk(
      context,
      read_buffer,
      buffer_size,
      read_callback,
      write_callback,
      user_data,
    );
  }

  late final _cloud_copy_process_chunkPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int64 Function(
            ffi.Pointer<CloudCopyContext>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            CloudCopyReadCallback,
            CloudCopyWriteCallback,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('cloud_copy_process_chunk');
  late final _cloud_copy_process_chunk = _cloud_copy_process_chunkPtr
      .asFunction<
        int Function(
          ffi.Pointer<CloudCopyContext>,
          ffi.Pointer<ffi.Uint8>,
          int,
          CloudCopyReadCallback,
          CloudCopyWriteCallback,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Finalize cloud-to-cloud copy
  ///
  /// @param context Pointer to CloudCopyContext
  /// @return 0 on success, error code on failure
  int cloud_copy_finalize(ffi.Pointer<CloudCopyContext> context) {
    return _cloud_copy_finalize(context);
  }

  late final _cloud_copy_finalizePtr =
      _lookup<
        ffi.NativeFunction<ffi.Int32 Function(ffi.Pointer<CloudCopyContext>)>
      >('cloud_copy_finalize');
  late final _cloud_copy_finalize = _cloud_copy_finalizePtr
      .asFunction<int Function(ffi.Pointer<CloudCopyContext>)>();

  /// Free cloud copy context
  ///
  /// @param context Pointer to CloudCopyContext
  void cloud_copy_free(ffi.Pointer<CloudCopyContext> context) {
    return _cloud_copy_free(context);
  }

  late final _cloud_copy_freePtr =
      _lookup<
        ffi.NativeFunction<ffi.Void Function(ffi.Pointer<CloudCopyContext>)>
      >('cloud_copy_free');
  late final _cloud_copy_free = _cloud_copy_freePtr
      .asFunction<void Function(ffi.Pointer<CloudCopyContext>)>();

  /// Get cloud copy progress
  ///
  /// @param context Pointer to CloudCopyContext
  /// @param bytes_copied Pointer to store bytes copied
  /// @param total_bytes Pointer to store total bytes
  void cloud_copy_get_progress(
    ffi.Pointer<CloudCopyContext> context,
    ffi.Pointer<ffi.Size> bytes_copied,
    ffi.Pointer<ffi.Size> total_bytes,
  ) {
    return _cloud_copy_get_progress(context, bytes_copied, total_bytes);
  }

  late final _cloud_copy_get_progressPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(
            ffi.Pointer<CloudCopyContext>,
            ffi.Pointer<ffi.Size>,
            ffi.Pointer<ffi.Size>,
          )
        >
      >('cloud_copy_get_progress');
  late final _cloud_copy_get_progress = _cloud_copy_get_progressPtr
      .asFunction<
        void Function(
          ffi.Pointer<CloudCopyContext>,
          ffi.Pointer<ffi.Size>,
          ffi.Pointer<ffi.Size>,
        )
      >();

  /// Initialize Google Drive to Google Drive copy context
  ffi.Pointer<GDriveToGDriveContext> gdrive_to_gdrive_init(
    int total_bytes,
    int total_files,
    int chunk_size,
    ffi.Pointer<ffi.Void> cancel_flag,
  ) {
    return _gdrive_to_gdrive_init(
      total_bytes,
      total_files,
      chunk_size,
      cancel_flag,
    );
  }

  late final _gdrive_to_gdrive_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<GDriveToGDriveContext> Function(
            ffi.Uint64,
            ffi.Uint32,
            ffi.Size,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('gdrive_to_gdrive_init');
  late final _gdrive_to_gdrive_init = _gdrive_to_gdrive_initPtr
      .asFunction<
        ffi.Pointer<GDriveToGDriveContext> Function(
          int,
          int,
          int,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Process one file in copy operation
  int gdrive_to_gdrive_process_file(
    ffi.Pointer<GDriveToGDriveContext> context,
    ffi.Pointer<ffi.Char> file_id,
    ffi.Pointer<ffi.Char> dest_name,
    int file_size,
    ffi.Pointer<ffi.Uint8> read_buffer,
    int buffer_size,
    GDriveReadCallback read_callback,
    GDriveWriteCallback write_callback,
    ffi.Pointer<ffi.Void> progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _gdrive_to_gdrive_process_file(
      context,
      file_id,
      dest_name,
      file_size,
      read_buffer,
      buffer_size,
      read_callback,
      write_callback,
      progress_callback,
      user_data,
    );
  }

  late final _gdrive_to_gdrive_process_filePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<GDriveToGDriveContext>,
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Char>,
            ffi.Uint64,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            GDriveReadCallback,
            GDriveWriteCallback,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('gdrive_to_gdrive_process_file');
  late final _gdrive_to_gdrive_process_file = _gdrive_to_gdrive_process_filePtr
      .asFunction<
        int Function(
          ffi.Pointer<GDriveToGDriveContext>,
          ffi.Pointer<ffi.Char>,
          ffi.Pointer<ffi.Char>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
          GDriveReadCallback,
          GDriveWriteCallback,
          ffi.Pointer<ffi.Void>,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Finalize Google Drive to Google Drive copy
  int gdrive_to_gdrive_finalize(
    ffi.Pointer<GDriveToGDriveContext> context,
    ffi.Pointer<ffi.Void> progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _gdrive_to_gdrive_finalize(context, progress_callback, user_data);
  }

  late final _gdrive_to_gdrive_finalizePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<GDriveToGDriveContext>,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('gdrive_to_gdrive_finalize');
  late final _gdrive_to_gdrive_finalize = _gdrive_to_gdrive_finalizePtr
      .asFunction<
        int Function(
          ffi.Pointer<GDriveToGDriveContext>,
          ffi.Pointer<ffi.Void>,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Free Google Drive to Google Drive copy context
  void gdrive_to_gdrive_free(ffi.Pointer<GDriveToGDriveContext> context) {
    return _gdrive_to_gdrive_free(context);
  }

  late final _gdrive_to_gdrive_freePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(ffi.Pointer<GDriveToGDriveContext>)
        >
      >('gdrive_to_gdrive_free');
  late final _gdrive_to_gdrive_free = _gdrive_to_gdrive_freePtr
      .asFunction<void Function(ffi.Pointer<GDriveToGDriveContext>)>();

  /// Get copy progress
  void gdrive_to_gdrive_get_progress(
    ffi.Pointer<GDriveToGDriveContext> context,
    ffi.Pointer<ffi.Uint64> bytes_copied,
    ffi.Pointer<ffi.Uint64> total_bytes,
    ffi.Pointer<ffi.Uint32> files_processed,
    ffi.Pointer<ffi.Uint32> total_files,
  ) {
    return _gdrive_to_gdrive_get_progress(
      context,
      bytes_copied,
      total_bytes,
      files_processed,
      total_files,
    );
  }

  late final _gdrive_to_gdrive_get_progressPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(
            ffi.Pointer<GDriveToGDriveContext>,
            ffi.Pointer<ffi.Uint64>,
            ffi.Pointer<ffi.Uint64>,
            ffi.Pointer<ffi.Uint32>,
            ffi.Pointer<ffi.Uint32>,
          )
        >
      >('gdrive_to_gdrive_get_progress');
  late final _gdrive_to_gdrive_get_progress = _gdrive_to_gdrive_get_progressPtr
      .asFunction<
        void Function(
          ffi.Pointer<GDriveToGDriveContext>,
          ffi.Pointer<ffi.Uint64>,
          ffi.Pointer<ffi.Uint64>,
          ffi.Pointer<ffi.Uint32>,
          ffi.Pointer<ffi.Uint32>,
        )
      >();

  /// Initialize OneDrive to OneDrive copy context
  ffi.Pointer<OneDriveToOneDriveContext> onedrive_to_onedrive_init(
    int total_bytes,
    int total_files,
    int chunk_size,
    ffi.Pointer<ffi.Void> cancel_flag,
  ) {
    return _onedrive_to_onedrive_init(
      total_bytes,
      total_files,
      chunk_size,
      cancel_flag,
    );
  }

  late final _onedrive_to_onedrive_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<OneDriveToOneDriveContext> Function(
            ffi.Uint64,
            ffi.Uint32,
            ffi.Size,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('onedrive_to_onedrive_init');
  late final _onedrive_to_onedrive_init = _onedrive_to_onedrive_initPtr
      .asFunction<
        ffi.Pointer<OneDriveToOneDriveContext> Function(
          int,
          int,
          int,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Process one file in copy operation
  int onedrive_to_onedrive_process_file(
    ffi.Pointer<OneDriveToOneDriveContext> context,
    ffi.Pointer<ffi.Char> source_item_id,
    ffi.Pointer<ffi.Char> dest_folder_id,
    ffi.Pointer<ffi.Char> dest_name,
    int file_size,
    ffi.Pointer<ffi.Uint8> read_buffer,
    int buffer_size,
    OneDriveReadCallback read_callback,
    OneDriveWriteCallback write_callback,
    ffi.Pointer<ffi.Void> progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _onedrive_to_onedrive_process_file(
      context,
      source_item_id,
      dest_folder_id,
      dest_name,
      file_size,
      read_buffer,
      buffer_size,
      read_callback,
      write_callback,
      progress_callback,
      user_data,
    );
  }

  late final _onedrive_to_onedrive_process_filePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<OneDriveToOneDriveContext>,
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Char>,
            ffi.Uint64,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            OneDriveReadCallback,
            OneDriveWriteCallback,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('onedrive_to_onedrive_process_file');
  late final _onedrive_to_onedrive_process_file =
      _onedrive_to_onedrive_process_filePtr
          .asFunction<
            int Function(
              ffi.Pointer<OneDriveToOneDriveContext>,
              ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Char>,
              int,
              ffi.Pointer<ffi.Uint8>,
              int,
              OneDriveReadCallback,
              OneDriveWriteCallback,
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<ffi.Void>,
            )
          >();

  /// Finalize OneDrive to OneDrive copy
  int onedrive_to_onedrive_finalize(
    ffi.Pointer<OneDriveToOneDriveContext> context,
    ffi.Pointer<ffi.Void> progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _onedrive_to_onedrive_finalize(
      context,
      progress_callback,
      user_data,
    );
  }

  late final _onedrive_to_onedrive_finalizePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<OneDriveToOneDriveContext>,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('onedrive_to_onedrive_finalize');
  late final _onedrive_to_onedrive_finalize = _onedrive_to_onedrive_finalizePtr
      .asFunction<
        int Function(
          ffi.Pointer<OneDriveToOneDriveContext>,
          ffi.Pointer<ffi.Void>,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Free OneDrive to OneDrive copy context
  void onedrive_to_onedrive_free(
    ffi.Pointer<OneDriveToOneDriveContext> context,
  ) {
    return _onedrive_to_onedrive_free(context);
  }

  late final _onedrive_to_onedrive_freePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(ffi.Pointer<OneDriveToOneDriveContext>)
        >
      >('onedrive_to_onedrive_free');
  late final _onedrive_to_onedrive_free = _onedrive_to_onedrive_freePtr
      .asFunction<void Function(ffi.Pointer<OneDriveToOneDriveContext>)>();

  /// Get copy progress
  void onedrive_to_onedrive_get_progress(
    ffi.Pointer<OneDriveToOneDriveContext> context,
    ffi.Pointer<ffi.Uint64> bytes_copied,
    ffi.Pointer<ffi.Uint64> total_bytes,
    ffi.Pointer<ffi.Uint32> files_processed,
    ffi.Pointer<ffi.Uint32> total_files,
  ) {
    return _onedrive_to_onedrive_get_progress(
      context,
      bytes_copied,
      total_bytes,
      files_processed,
      total_files,
    );
  }

  late final _onedrive_to_onedrive_get_progressPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(
            ffi.Pointer<OneDriveToOneDriveContext>,
            ffi.Pointer<ffi.Uint64>,
            ffi.Pointer<ffi.Uint64>,
            ffi.Pointer<ffi.Uint32>,
            ffi.Pointer<ffi.Uint32>,
          )
        >
      >('onedrive_to_onedrive_get_progress');
  late final _onedrive_to_onedrive_get_progress =
      _onedrive_to_onedrive_get_progressPtr
          .asFunction<
            void Function(
              ffi.Pointer<OneDriveToOneDriveContext>,
              ffi.Pointer<ffi.Uint64>,
              ffi.Pointer<ffi.Uint64>,
              ffi.Pointer<ffi.Uint32>,
              ffi.Pointer<ffi.Uint32>,
            )
          >();

  /// Initialize Google Drive to OneDrive copy context
  ffi.Pointer<GDriveToOneDriveContext> gdrive_to_onedrive_init(
    int total_bytes,
    int total_files,
    int chunk_size,
    ffi.Pointer<ffi.Void> cancel_flag,
  ) {
    return _gdrive_to_onedrive_init(
      total_bytes,
      total_files,
      chunk_size,
      cancel_flag,
    );
  }

  late final _gdrive_to_onedrive_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<GDriveToOneDriveContext> Function(
            ffi.Uint64,
            ffi.Uint32,
            ffi.Size,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('gdrive_to_onedrive_init');
  late final _gdrive_to_onedrive_init = _gdrive_to_onedrive_initPtr
      .asFunction<
        ffi.Pointer<GDriveToOneDriveContext> Function(
          int,
          int,
          int,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Process one file in copy operation
  int gdrive_to_onedrive_process_file(
    ffi.Pointer<GDriveToOneDriveContext> context,
    ffi.Pointer<ffi.Char> gdrive_file_id,
    ffi.Pointer<ffi.Char> onedrive_dest_folder_id,
    ffi.Pointer<ffi.Char> dest_name,
    int file_size,
    ffi.Pointer<ffi.Uint8> read_buffer,
    int buffer_size,
    GDriveReadCallback read_callback,
    OneDriveWriteCallback write_callback,
    ffi.Pointer<ffi.Void> progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _gdrive_to_onedrive_process_file(
      context,
      gdrive_file_id,
      onedrive_dest_folder_id,
      dest_name,
      file_size,
      read_buffer,
      buffer_size,
      read_callback,
      write_callback,
      progress_callback,
      user_data,
    );
  }

  late final _gdrive_to_onedrive_process_filePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<GDriveToOneDriveContext>,
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Char>,
            ffi.Uint64,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            GDriveReadCallback,
            OneDriveWriteCallback,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('gdrive_to_onedrive_process_file');
  late final _gdrive_to_onedrive_process_file =
      _gdrive_to_onedrive_process_filePtr
          .asFunction<
            int Function(
              ffi.Pointer<GDriveToOneDriveContext>,
              ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Char>,
              int,
              ffi.Pointer<ffi.Uint8>,
              int,
              GDriveReadCallback,
              OneDriveWriteCallback,
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<ffi.Void>,
            )
          >();

  /// Finalize Google Drive to OneDrive copy
  int gdrive_to_onedrive_finalize(
    ffi.Pointer<GDriveToOneDriveContext> context,
    ffi.Pointer<ffi.Void> progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _gdrive_to_onedrive_finalize(context, progress_callback, user_data);
  }

  late final _gdrive_to_onedrive_finalizePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<GDriveToOneDriveContext>,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('gdrive_to_onedrive_finalize');
  late final _gdrive_to_onedrive_finalize = _gdrive_to_onedrive_finalizePtr
      .asFunction<
        int Function(
          ffi.Pointer<GDriveToOneDriveContext>,
          ffi.Pointer<ffi.Void>,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Free Google Drive to OneDrive copy context
  void gdrive_to_onedrive_free(ffi.Pointer<GDriveToOneDriveContext> context) {
    return _gdrive_to_onedrive_free(context);
  }

  late final _gdrive_to_onedrive_freePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(ffi.Pointer<GDriveToOneDriveContext>)
        >
      >('gdrive_to_onedrive_free');
  late final _gdrive_to_onedrive_free = _gdrive_to_onedrive_freePtr
      .asFunction<void Function(ffi.Pointer<GDriveToOneDriveContext>)>();

  /// Get copy progress
  void gdrive_to_onedrive_get_progress(
    ffi.Pointer<GDriveToOneDriveContext> context,
    ffi.Pointer<ffi.Uint64> bytes_copied,
    ffi.Pointer<ffi.Uint64> total_bytes,
    ffi.Pointer<ffi.Uint32> files_processed,
    ffi.Pointer<ffi.Uint32> total_files,
  ) {
    return _gdrive_to_onedrive_get_progress(
      context,
      bytes_copied,
      total_bytes,
      files_processed,
      total_files,
    );
  }

  late final _gdrive_to_onedrive_get_progressPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(
            ffi.Pointer<GDriveToOneDriveContext>,
            ffi.Pointer<ffi.Uint64>,
            ffi.Pointer<ffi.Uint64>,
            ffi.Pointer<ffi.Uint32>,
            ffi.Pointer<ffi.Uint32>,
          )
        >
      >('gdrive_to_onedrive_get_progress');
  late final _gdrive_to_onedrive_get_progress =
      _gdrive_to_onedrive_get_progressPtr
          .asFunction<
            void Function(
              ffi.Pointer<GDriveToOneDriveContext>,
              ffi.Pointer<ffi.Uint64>,
              ffi.Pointer<ffi.Uint64>,
              ffi.Pointer<ffi.Uint32>,
              ffi.Pointer<ffi.Uint32>,
            )
          >();

  /// Initialize OneDrive to Google Drive copy context
  ffi.Pointer<OneDriveToGDriveContext> onedrive_to_gdrive_init(
    int total_bytes,
    int total_files,
    int chunk_size,
    ffi.Pointer<ffi.Void> cancel_flag,
  ) {
    return _onedrive_to_gdrive_init(
      total_bytes,
      total_files,
      chunk_size,
      cancel_flag,
    );
  }

  late final _onedrive_to_gdrive_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<OneDriveToGDriveContext> Function(
            ffi.Uint64,
            ffi.Uint32,
            ffi.Size,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('onedrive_to_gdrive_init');
  late final _onedrive_to_gdrive_init = _onedrive_to_gdrive_initPtr
      .asFunction<
        ffi.Pointer<OneDriveToGDriveContext> Function(
          int,
          int,
          int,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Process one file in copy operation
  int onedrive_to_gdrive_process_file(
    ffi.Pointer<OneDriveToGDriveContext> context,
    ffi.Pointer<ffi.Char> onedrive_item_id,
    ffi.Pointer<ffi.Char> gdrive_dest_folder_id,
    ffi.Pointer<ffi.Char> dest_name,
    int file_size,
    ffi.Pointer<ffi.Uint8> read_buffer,
    int buffer_size,
    OneDriveReadCallback read_callback,
    GDriveWriteCallback write_callback,
    ffi.Pointer<ffi.Void> progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _onedrive_to_gdrive_process_file(
      context,
      onedrive_item_id,
      gdrive_dest_folder_id,
      dest_name,
      file_size,
      read_buffer,
      buffer_size,
      read_callback,
      write_callback,
      progress_callback,
      user_data,
    );
  }

  late final _onedrive_to_gdrive_process_filePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<OneDriveToGDriveContext>,
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Char>,
            ffi.Uint64,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            OneDriveReadCallback,
            GDriveWriteCallback,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('onedrive_to_gdrive_process_file');
  late final _onedrive_to_gdrive_process_file =
      _onedrive_to_gdrive_process_filePtr
          .asFunction<
            int Function(
              ffi.Pointer<OneDriveToGDriveContext>,
              ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Char>,
              ffi.Pointer<ffi.Char>,
              int,
              ffi.Pointer<ffi.Uint8>,
              int,
              OneDriveReadCallback,
              GDriveWriteCallback,
              ffi.Pointer<ffi.Void>,
              ffi.Pointer<ffi.Void>,
            )
          >();

  /// Finalize OneDrive to Google Drive copy
  int onedrive_to_gdrive_finalize(
    ffi.Pointer<OneDriveToGDriveContext> context,
    ffi.Pointer<ffi.Void> progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _onedrive_to_gdrive_finalize(context, progress_callback, user_data);
  }

  late final _onedrive_to_gdrive_finalizePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<OneDriveToGDriveContext>,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('onedrive_to_gdrive_finalize');
  late final _onedrive_to_gdrive_finalize = _onedrive_to_gdrive_finalizePtr
      .asFunction<
        int Function(
          ffi.Pointer<OneDriveToGDriveContext>,
          ffi.Pointer<ffi.Void>,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Free OneDrive to Google Drive copy context
  void onedrive_to_gdrive_free(ffi.Pointer<OneDriveToGDriveContext> context) {
    return _onedrive_to_gdrive_free(context);
  }

  late final _onedrive_to_gdrive_freePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(ffi.Pointer<OneDriveToGDriveContext>)
        >
      >('onedrive_to_gdrive_free');
  late final _onedrive_to_gdrive_free = _onedrive_to_gdrive_freePtr
      .asFunction<void Function(ffi.Pointer<OneDriveToGDriveContext>)>();

  /// Get copy progress
  void onedrive_to_gdrive_get_progress(
    ffi.Pointer<OneDriveToGDriveContext> context,
    ffi.Pointer<ffi.Uint64> bytes_copied,
    ffi.Pointer<ffi.Uint64> total_bytes,
    ffi.Pointer<ffi.Uint32> files_processed,
    ffi.Pointer<ffi.Uint32> total_files,
  ) {
    return _onedrive_to_gdrive_get_progress(
      context,
      bytes_copied,
      total_bytes,
      files_processed,
      total_files,
    );
  }

  late final _onedrive_to_gdrive_get_progressPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(
            ffi.Pointer<OneDriveToGDriveContext>,
            ffi.Pointer<ffi.Uint64>,
            ffi.Pointer<ffi.Uint64>,
            ffi.Pointer<ffi.Uint32>,
            ffi.Pointer<ffi.Uint32>,
          )
        >
      >('onedrive_to_gdrive_get_progress');
  late final _onedrive_to_gdrive_get_progress =
      _onedrive_to_gdrive_get_progressPtr
          .asFunction<
            void Function(
              ffi.Pointer<OneDriveToGDriveContext>,
              ffi.Pointer<ffi.Uint64>,
              ffi.Pointer<ffi.Uint64>,
              ffi.Pointer<ffi.Uint32>,
              ffi.Pointer<ffi.Uint32>,
            )
          >();

  /// Initialize Virtual Drive copy context
  ffi.Pointer<VirtualCopyContext> virtual_copy_init(
    int total_bytes,
    int total_files,
    int accounts_count,
    int chunk_size,
    ffi.Pointer<ffi.Void> cancel_flag,
  ) {
    return _virtual_copy_init(
      total_bytes,
      total_files,
      accounts_count,
      chunk_size,
      cancel_flag,
    );
  }

  late final _virtual_copy_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<VirtualCopyContext> Function(
            ffi.Uint64,
            ffi.Uint32,
            ffi.Uint32,
            ffi.Size,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('virtual_copy_init');
  late final _virtual_copy_init = _virtual_copy_initPtr
      .asFunction<
        ffi.Pointer<VirtualCopyContext> Function(
          int,
          int,
          int,
          int,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Process one file copy to all accounts
  int virtual_copy_process_file(
    ffi.Pointer<VirtualCopyContext> context,
    ffi.Pointer<ffi.Char> source_file_id,
    ffi.Pointer<ffi.Pointer<ffi.Char>> dest_folder_ids,
    ffi.Pointer<ffi.Pointer<ffi.Char>> dest_names,
    int file_size,
    ffi.Pointer<ffi.Uint8> read_buffer,
    int buffer_size,
    VirtualReadCallback read_callback,
    VirtualWriteCallback write_callback,
    ffi.Pointer<ffi.Void> progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _virtual_copy_process_file(
      context,
      source_file_id,
      dest_folder_ids,
      dest_names,
      file_size,
      read_buffer,
      buffer_size,
      read_callback,
      write_callback,
      progress_callback,
      user_data,
    );
  }

  late final _virtual_copy_process_filePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<VirtualCopyContext>,
            ffi.Pointer<ffi.Char>,
            ffi.Pointer<ffi.Pointer<ffi.Char>>,
            ffi.Pointer<ffi.Pointer<ffi.Char>>,
            ffi.Uint64,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            VirtualReadCallback,
            VirtualWriteCallback,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('virtual_copy_process_file');
  late final _virtual_copy_process_file = _virtual_copy_process_filePtr
      .asFunction<
        int Function(
          ffi.Pointer<VirtualCopyContext>,
          ffi.Pointer<ffi.Char>,
          ffi.Pointer<ffi.Pointer<ffi.Char>>,
          ffi.Pointer<ffi.Pointer<ffi.Char>>,
          int,
          ffi.Pointer<ffi.Uint8>,
          int,
          VirtualReadCallback,
          VirtualWriteCallback,
          ffi.Pointer<ffi.Void>,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Finalize Virtual Drive copy
  int virtual_copy_finalize(
    ffi.Pointer<VirtualCopyContext> context,
    ffi.Pointer<ffi.Void> progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _virtual_copy_finalize(context, progress_callback, user_data);
  }

  late final _virtual_copy_finalizePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<VirtualCopyContext>,
            ffi.Pointer<ffi.Void>,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('virtual_copy_finalize');
  late final _virtual_copy_finalize = _virtual_copy_finalizePtr
      .asFunction<
        int Function(
          ffi.Pointer<VirtualCopyContext>,
          ffi.Pointer<ffi.Void>,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Free Virtual Drive copy context
  void virtual_copy_free(ffi.Pointer<VirtualCopyContext> context) {
    return _virtual_copy_free(context);
  }

  late final _virtual_copy_freePtr =
      _lookup<
        ffi.NativeFunction<ffi.Void Function(ffi.Pointer<VirtualCopyContext>)>
      >('virtual_copy_free');
  late final _virtual_copy_free = _virtual_copy_freePtr
      .asFunction<void Function(ffi.Pointer<VirtualCopyContext>)>();

  /// Get copy progress
  void virtual_copy_get_progress(
    ffi.Pointer<VirtualCopyContext> context,
    ffi.Pointer<ffi.Uint64> bytes_copied,
    ffi.Pointer<ffi.Uint64> total_bytes,
    ffi.Pointer<ffi.Uint32> files_processed,
    ffi.Pointer<ffi.Uint32> total_files,
  ) {
    return _virtual_copy_get_progress(
      context,
      bytes_copied,
      total_bytes,
      files_processed,
      total_files,
    );
  }

  late final _virtual_copy_get_progressPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(
            ffi.Pointer<VirtualCopyContext>,
            ffi.Pointer<ffi.Uint64>,
            ffi.Pointer<ffi.Uint64>,
            ffi.Pointer<ffi.Uint32>,
            ffi.Pointer<ffi.Uint32>,
          )
        >
      >('virtual_copy_get_progress');
  late final _virtual_copy_get_progress = _virtual_copy_get_progressPtr
      .asFunction<
        void Function(
          ffi.Pointer<VirtualCopyContext>,
          ffi.Pointer<ffi.Uint64>,
          ffi.Pointer<ffi.Uint64>,
          ffi.Pointer<ffi.Uint32>,
          ffi.Pointer<ffi.Uint32>,
        )
      >();

  /// Initialize unified copy context
  ///
  /// @param total_bytes Total bytes to copy across all files
  /// @param total_files Total number of files to copy
  /// @param chunk_size Size of chunks in bytes (64KB minimum, 10MB maximum)
  /// @param cancel_flag Pointer to AtomicBool for cancellation (can be NULL)
  /// @return Pointer to UnifiedCopyContext, or NULL on error
  ffi.Pointer<UnifiedCopyContext> unified_copy_init(
    int total_bytes,
    int total_files,
    int chunk_size,
    ffi.Pointer<ffi.Void> cancel_flag,
  ) {
    return _unified_copy_init(
      total_bytes,
      total_files,
      chunk_size,
      cancel_flag,
    );
  }

  late final _unified_copy_initPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Pointer<UnifiedCopyContext> Function(
            ffi.Uint64,
            ffi.Uint32,
            ffi.Size,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('unified_copy_init');
  late final _unified_copy_init = _unified_copy_initPtr
      .asFunction<
        ffi.Pointer<UnifiedCopyContext> Function(
          int,
          int,
          int,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Process one file copy operation
  ///
  /// This function orchestrates the downloaduploadclear loop:
  /// 1. Download chunk from source (via read_callback)
  /// 2. Chunk is now in RAM buffer
  /// 3. Upload chunk to destination (via write_callback)
  /// 4. Clear RAM buffer (automatic - buffer reused for next chunk)
  /// 5. Repeat until EOF
  ///
  /// @param context Pointer to UnifiedCopyContext
  /// @param read_buffer Pre-allocated RAM buffer for chunk data
  /// @param buffer_size Size of the buffer (should match chunk_size)
  /// @param file_size Size of the file being copied
  /// @param read_callback Callback to download chunk from source
  /// @param write_callback Callback to upload chunk to destination
  /// @param progress_callback Optional progress callback
  /// @param user_data User data for callbacks
  /// @return 1 if more files to process, 0 if done, negative error code on failure
  int unified_copy_file(
    ffi.Pointer<UnifiedCopyContext> context,
    ffi.Pointer<ffi.Uint8> read_buffer,
    int buffer_size,
    int file_size,
    UnifiedReadCallback read_callback,
    UnifiedWriteCallback write_callback,
    UnifiedProgressCallback progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _unified_copy_file(
      context,
      read_buffer,
      buffer_size,
      file_size,
      read_callback,
      write_callback,
      progress_callback,
      user_data,
    );
  }

  late final _unified_copy_filePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<UnifiedCopyContext>,
            ffi.Pointer<ffi.Uint8>,
            ffi.Size,
            ffi.Uint64,
            UnifiedReadCallback,
            UnifiedWriteCallback,
            UnifiedProgressCallback,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('unified_copy_file');
  late final _unified_copy_file = _unified_copy_filePtr
      .asFunction<
        int Function(
          ffi.Pointer<UnifiedCopyContext>,
          ffi.Pointer<ffi.Uint8>,
          int,
          int,
          UnifiedReadCallback,
          UnifiedWriteCallback,
          UnifiedProgressCallback,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Finalize copy operation and send final progress update
  ///
  /// @param context Pointer to UnifiedCopyContext
  /// @param progress_callback Optional final progress callback
  /// @param user_data User data for callback
  /// @return 0 on success, error code on failure
  int unified_copy_finalize(
    ffi.Pointer<UnifiedCopyContext> context,
    UnifiedProgressCallback progress_callback,
    ffi.Pointer<ffi.Void> user_data,
  ) {
    return _unified_copy_finalize(context, progress_callback, user_data);
  }

  late final _unified_copy_finalizePtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Int32 Function(
            ffi.Pointer<UnifiedCopyContext>,
            UnifiedProgressCallback,
            ffi.Pointer<ffi.Void>,
          )
        >
      >('unified_copy_finalize');
  late final _unified_copy_finalize = _unified_copy_finalizePtr
      .asFunction<
        int Function(
          ffi.Pointer<UnifiedCopyContext>,
          UnifiedProgressCallback,
          ffi.Pointer<ffi.Void>,
        )
      >();

  /// Free unified copy context
  ///
  /// @param context Pointer to UnifiedCopyContext to free
  void unified_copy_free(ffi.Pointer<UnifiedCopyContext> context) {
    return _unified_copy_free(context);
  }

  late final _unified_copy_freePtr =
      _lookup<
        ffi.NativeFunction<ffi.Void Function(ffi.Pointer<UnifiedCopyContext>)>
      >('unified_copy_free');
  late final _unified_copy_free = _unified_copy_freePtr
      .asFunction<void Function(ffi.Pointer<UnifiedCopyContext>)>();

  /// Get copy progress
  ///
  /// @param context Pointer to UnifiedCopyContext
  /// @param bytes_copied Pointer to store bytes copied
  /// @param total_bytes Pointer to store total bytes
  /// @param files_processed Pointer to store files processed
  /// @param total_files Pointer to store total files
  void unified_copy_get_progress(
    ffi.Pointer<UnifiedCopyContext> context,
    ffi.Pointer<ffi.Uint64> bytes_copied,
    ffi.Pointer<ffi.Uint64> total_bytes,
    ffi.Pointer<ffi.Uint32> files_processed,
    ffi.Pointer<ffi.Uint32> total_files,
  ) {
    return _unified_copy_get_progress(
      context,
      bytes_copied,
      total_bytes,
      files_processed,
      total_files,
    );
  }

  late final _unified_copy_get_progressPtr =
      _lookup<
        ffi.NativeFunction<
          ffi.Void Function(
            ffi.Pointer<UnifiedCopyContext>,
            ffi.Pointer<ffi.Uint64>,
            ffi.Pointer<ffi.Uint64>,
            ffi.Pointer<ffi.Uint32>,
            ffi.Pointer<ffi.Uint32>,
          )
        >
      >('unified_copy_get_progress');
  late final _unified_copy_get_progress = _unified_copy_get_progressPtr
      .asFunction<
        void Function(
          ffi.Pointer<UnifiedCopyContext>,
          ffi.Pointer<ffi.Uint64>,
          ffi.Pointer<ffi.Uint64>,
          ffi.Pointer<ffi.Uint32>,
          ffi.Pointer<ffi.Uint32>,
        )
      >();

  /// Get bytes copied so far (simple accessor)
  ///
  /// @param context Pointer to UnifiedCopyContext
  /// @return Bytes copied, or 0 if invalid context
  int unified_copy_get_bytes_copied(ffi.Pointer<UnifiedCopyContext> context) {
    return _unified_copy_get_bytes_copied(context);
  }

  late final _unified_copy_get_bytes_copiedPtr =
      _lookup<
        ffi.NativeFunction<ffi.Uint64 Function(ffi.Pointer<UnifiedCopyContext>)>
      >('unified_copy_get_bytes_copied');
  late final _unified_copy_get_bytes_copied = _unified_copy_get_bytes_copiedPtr
      .asFunction<int Function(ffi.Pointer<UnifiedCopyContext>)>();

  /// Get total bytes (simple accessor)
  ///
  /// @param context Pointer to UnifiedCopyContext
  /// @return Total bytes, or 0 if invalid context
  int unified_copy_get_total_bytes(ffi.Pointer<UnifiedCopyContext> context) {
    return _unified_copy_get_total_bytes(context);
  }

  late final _unified_copy_get_total_bytesPtr =
      _lookup<
        ffi.NativeFunction<ffi.Uint64 Function(ffi.Pointer<UnifiedCopyContext>)>
      >('unified_copy_get_total_bytes');
  late final _unified_copy_get_total_bytes = _unified_copy_get_total_bytesPtr
      .asFunction<int Function(ffi.Pointer<UnifiedCopyContext>)>();

  /// Get files processed (simple accessor)
  ///
  /// @param context Pointer to UnifiedCopyContext
  /// @return Files processed, or 0 if invalid context
  int unified_copy_get_files_processed(
    ffi.Pointer<UnifiedCopyContext> context,
  ) {
    return _unified_copy_get_files_processed(context);
  }

  late final _unified_copy_get_files_processedPtr =
      _lookup<
        ffi.NativeFunction<ffi.Uint32 Function(ffi.Pointer<UnifiedCopyContext>)>
      >('unified_copy_get_files_processed');
  late final _unified_copy_get_files_processed =
      _unified_copy_get_files_processedPtr
          .asFunction<int Function(ffi.Pointer<UnifiedCopyContext>)>();

  /// Get total files (simple accessor)
  ///
  /// @param context Pointer to UnifiedCopyContext
  /// @return Total files, or 0 if invalid context
  int unified_copy_get_total_files(ffi.Pointer<UnifiedCopyContext> context) {
    return _unified_copy_get_total_files(context);
  }

  late final _unified_copy_get_total_filesPtr =
      _lookup<
        ffi.NativeFunction<ffi.Uint32 Function(ffi.Pointer<UnifiedCopyContext>)>
      >('unified_copy_get_total_files');
  late final _unified_copy_get_total_files = _unified_copy_get_total_filesPtr
      .asFunction<int Function(ffi.Pointer<UnifiedCopyContext>)>();
}

typedef va_list = ffi.Pointer<ffi.Char>;

final class __crt_locale_data_public extends ffi.Struct {
  external ffi.Pointer<ffi.UnsignedShort> _locale_pctype;

  @ffi.Int()
  external int _locale_mb_cur_max;

  @ffi.UnsignedInt()
  external int _locale_lc_codepage;
}

final class __crt_locale_pointers extends ffi.Struct {
  external ffi.Pointer<__crt_locale_data> locinfo;

  external ffi.Pointer<__crt_multibyte_data> mbcinfo;
}

final class __crt_locale_data extends ffi.Opaque {}

final class __crt_multibyte_data extends ffi.Opaque {}

final class _Mbstatet extends ffi.Struct {
  @ffi.UnsignedLong()
  external int _Wchar;

  @ffi.UnsignedShort()
  external int _Byte;

  @ffi.UnsignedShort()
  external int _State;
}

typedef errno_t = ffi.Int;
typedef Darterrno_t = int;

/// Progress callback type for encryption/decryption operations
///
/// @param bytes_processed Number of bytes processed so far
/// @param total_bytes Total number of bytes to process
/// @param user_data User-provided data pointer
typedef ProgressCallback =
    ffi.Pointer<ffi.NativeFunction<ProgressCallbackFunction>>;
typedef ProgressCallbackFunction =
    ffi.Void Function(
      ffi.Size bytes_processed,
      ffi.Size total_bytes,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartProgressCallbackFunction =
    void Function(
      int bytes_processed,
      int total_bytes,
      ffi.Pointer<ffi.Void> user_data,
    );

final class EncryptionContext extends ffi.Opaque {}

final class DecryptionContext extends ffi.Opaque {}

final class FolderScanContext extends ffi.Opaque {}

final class UploadContext extends ffi.Opaque {}

/// Progress callback for upload operations
typedef UploadProgressCallback =
    ffi.Pointer<ffi.NativeFunction<UploadProgressCallbackFunction>>;
typedef UploadProgressCallbackFunction =
    ffi.Void Function(
      ffi.Size bytes_processed,
      ffi.Size total_bytes,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartUploadProgressCallbackFunction =
    void Function(
      int bytes_processed,
      int total_bytes,
      ffi.Pointer<ffi.Void> user_data,
    );

/// Data callback for providing encrypted chunks to Dart
typedef UploadDataCallback =
    ffi.Pointer<ffi.NativeFunction<UploadDataCallbackFunction>>;
typedef UploadDataCallbackFunction =
    ffi.Void Function(
      ffi.Pointer<ffi.Uint8> data,
      ffi.Size data_len,
      ffi.Uint32 chunk_index,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartUploadDataCallbackFunction =
    void Function(
      ffi.Pointer<ffi.Uint8> data,
      int data_len,
      int chunk_index,
      ffi.Pointer<ffi.Void> user_data,
    );

final class DownloadContext extends ffi.Opaque {}

/// Progress callback for download operations
typedef DownloadProgressCallback =
    ffi.Pointer<ffi.NativeFunction<DownloadProgressCallbackFunction>>;
typedef DownloadProgressCallbackFunction =
    ffi.Void Function(
      ffi.Size bytes_written,
      ffi.Size total_bytes,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartDownloadProgressCallbackFunction =
    void Function(
      int bytes_written,
      int total_bytes,
      ffi.Pointer<ffi.Void> user_data,
    );

final class CopyContext extends ffi.Opaque {}

final class ChunkedCopyContext extends ffi.Opaque {}

/// Data callback for chunked copy - receives chunk data
/// @param data Pointer to chunk data
/// @param data_len Length of data
/// @param user_data User-provided data pointer
/// @return Bytes written to buffer (negative for error)
typedef CopyDataCallback =
    ffi.Pointer<ffi.NativeFunction<CopyDataCallbackFunction>>;
typedef CopyDataCallbackFunction =
    ffi.IntPtr Function(
      ffi.Pointer<ffi.Uint8> data,
      ffi.Size data_len,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartCopyDataCallbackFunction =
    int Function(
      ffi.Pointer<ffi.Uint8> data,
      int data_len,
      ffi.Pointer<ffi.Void> user_data,
    );

final class CloudCopyContext extends ffi.Opaque {}

/// Read callback for cloud copy - Dart provides data from source stream
/// @param buffer Buffer to fill with data
/// @param buffer_size Size of buffer
/// @param user_data User-provided data pointer
/// @return Bytes read (0 for EOF), negative for error
typedef CloudCopyReadCallback =
    ffi.Pointer<ffi.NativeFunction<CloudCopyReadCallbackFunction>>;
typedef CloudCopyReadCallbackFunction =
    ffi.Int64 Function(
      ffi.Pointer<ffi.Uint8> buffer,
      ffi.Size buffer_size,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartCloudCopyReadCallbackFunction =
    int Function(
      ffi.Pointer<ffi.Uint8> buffer,
      int buffer_size,
      ffi.Pointer<ffi.Void> user_data,
    );

/// Write callback for cloud copy - Dart receives data for destination stream
/// @param data Pointer to data
/// @param data_len Length of data
/// @param user_data User-provided data pointer
/// @return 0 on success, negative for error
typedef CloudCopyWriteCallback =
    ffi.Pointer<ffi.NativeFunction<CloudCopyWriteCallbackFunction>>;
typedef CloudCopyWriteCallbackFunction =
    ffi.Int32 Function(
      ffi.Pointer<ffi.Uint8> data,
      ffi.Size data_len,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartCloudCopyWriteCallbackFunction =
    int Function(
      ffi.Pointer<ffi.Uint8> data,
      int data_len,
      ffi.Pointer<ffi.Void> user_data,
    );

final class GDriveToGDriveContext extends ffi.Opaque {}

/// Read callback for Google Drive copy - Dart provides data from source
typedef GDriveReadCallback =
    ffi.Pointer<ffi.NativeFunction<GDriveReadCallbackFunction>>;
typedef GDriveReadCallbackFunction =
    ffi.Int64 Function(
      ffi.Pointer<ffi.Uint8> buffer,
      ffi.Size buffer_size,
      ffi.Uint64 file_offset,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartGDriveReadCallbackFunction =
    int Function(
      ffi.Pointer<ffi.Uint8> buffer,
      int buffer_size,
      int file_offset,
      ffi.Pointer<ffi.Void> user_data,
    );

/// Write callback for Google Drive copy - Dart receives data for destination
typedef GDriveWriteCallback =
    ffi.Pointer<ffi.NativeFunction<GDriveWriteCallbackFunction>>;
typedef GDriveWriteCallbackFunction =
    ffi.Int32 Function(
      ffi.Pointer<ffi.Uint8> data,
      ffi.Size data_len,
      ffi.Uint64 file_offset,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartGDriveWriteCallbackFunction =
    int Function(
      ffi.Pointer<ffi.Uint8> data,
      int data_len,
      int file_offset,
      ffi.Pointer<ffi.Void> user_data,
    );

final class OneDriveToOneDriveContext extends ffi.Opaque {}

/// Read callback for OneDrive copy - Dart provides data from source
typedef OneDriveReadCallback =
    ffi.Pointer<ffi.NativeFunction<OneDriveReadCallbackFunction>>;
typedef OneDriveReadCallbackFunction =
    ffi.Int64 Function(
      ffi.Pointer<ffi.Uint8> buffer,
      ffi.Size buffer_size,
      ffi.Uint64 file_offset,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartOneDriveReadCallbackFunction =
    int Function(
      ffi.Pointer<ffi.Uint8> buffer,
      int buffer_size,
      int file_offset,
      ffi.Pointer<ffi.Void> user_data,
    );

/// Write callback for OneDrive copy - Dart receives data for destination
typedef OneDriveWriteCallback =
    ffi.Pointer<ffi.NativeFunction<OneDriveWriteCallbackFunction>>;
typedef OneDriveWriteCallbackFunction =
    ffi.Int32 Function(
      ffi.Pointer<ffi.Uint8> data,
      ffi.Size data_len,
      ffi.Uint64 file_offset,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartOneDriveWriteCallbackFunction =
    int Function(
      ffi.Pointer<ffi.Uint8> data,
      int data_len,
      int file_offset,
      ffi.Pointer<ffi.Void> user_data,
    );

final class GDriveToOneDriveContext extends ffi.Opaque {}

final class OneDriveToGDriveContext extends ffi.Opaque {}

final class VirtualCopyContext extends ffi.Opaque {}

/// Read callback for Virtual copy - Dart provides data from source
typedef VirtualReadCallback =
    ffi.Pointer<ffi.NativeFunction<VirtualReadCallbackFunction>>;
typedef VirtualReadCallbackFunction =
    ffi.Int64 Function(
      ffi.Pointer<ffi.Uint8> buffer,
      ffi.Size buffer_size,
      ffi.Uint64 file_offset,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartVirtualReadCallbackFunction =
    int Function(
      ffi.Pointer<ffi.Uint8> buffer,
      int buffer_size,
      int file_offset,
      ffi.Pointer<ffi.Void> user_data,
    );

/// Write callback for Virtual copy - Dart receives data for all destinations
typedef VirtualWriteCallback =
    ffi.Pointer<ffi.NativeFunction<VirtualWriteCallbackFunction>>;
typedef VirtualWriteCallbackFunction =
    ffi.Int32 Function(
      ffi.Pointer<ffi.Uint8> data,
      ffi.Size data_len,
      ffi.Uint64 file_offset,
      ffi.Uint32 account_index,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartVirtualWriteCallbackFunction =
    int Function(
      ffi.Pointer<ffi.Uint8> data,
      int data_len,
      int file_offset,
      int account_index,
      ffi.Pointer<ffi.Void> user_data,
    );

final class UnifiedCopyContext extends ffi.Opaque {}

/// Read callback: Dart downloads chunk from source cloud into buffer
/// @param buffer RAM buffer to fill with downloaded data
/// @param buffer_size Size of buffer
/// @param offset File offset to read from
/// @param user_data User data
/// @return Number of bytes read (0 for EOF, negative for error)
typedef UnifiedReadCallback =
    ffi.Pointer<ffi.NativeFunction<UnifiedReadCallbackFunction>>;
typedef UnifiedReadCallbackFunction =
    ffi.Int64 Function(
      ffi.Pointer<ffi.Uint8> buffer,
      ffi.Size buffer_size,
      ffi.Uint64 offset,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartUnifiedReadCallbackFunction =
    int Function(
      ffi.Pointer<ffi.Uint8> buffer,
      int buffer_size,
      int offset,
      ffi.Pointer<ffi.Void> user_data,
    );

/// Write callback: Dart uploads chunk from buffer to destination cloud
/// @param data Pointer to chunk data in RAM
/// @param data_len Length of data
/// @param offset File offset to write to
/// @param user_data User data
/// @return 0 on success, negative on error
typedef UnifiedWriteCallback =
    ffi.Pointer<ffi.NativeFunction<UnifiedWriteCallbackFunction>>;
typedef UnifiedWriteCallbackFunction =
    ffi.Int32 Function(
      ffi.Pointer<ffi.Uint8> data,
      ffi.Size data_len,
      ffi.Uint64 offset,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartUnifiedWriteCallbackFunction =
    int Function(
      ffi.Pointer<ffi.Uint8> data,
      int data_len,
      int offset,
      ffi.Pointer<ffi.Void> user_data,
    );

/// Progress callback for unified copy operations
/// @param bytes_copied Number of bytes copied so far
/// @param total_bytes Total bytes to copy
/// @param files_processed Number of files processed
/// @param total_files Total number of files
/// @param user_data User-provided data pointer
typedef UnifiedProgressCallback =
    ffi.Pointer<ffi.NativeFunction<UnifiedProgressCallbackFunction>>;
typedef UnifiedProgressCallbackFunction =
    ffi.Void Function(
      ffi.Uint64 bytes_copied,
      ffi.Uint64 total_bytes,
      ffi.Uint32 files_processed,
      ffi.Uint32 total_files,
      ffi.Pointer<ffi.Void> user_data,
    );
typedef DartUnifiedProgressCallbackFunction =
    void Function(
      int bytes_copied,
      int total_bytes,
      int files_processed,
      int total_files,
      ffi.Pointer<ffi.Void> user_data,
    );

const int _VCRT_COMPILER_PREPROCESSOR = 1;

const int _SAL_VERSION = 20;

const int __SAL_H_VERSION = 180000000;

const int _USE_DECLSPECS_FOR_SAL = 0;

const int _USE_ATTRIBUTES_FOR_SAL = 0;

const int _CRT_PACKING = 8;

const int _VCRUNTIME_DISABLED_WARNINGS = 4514;

const int _HAS_EXCEPTIONS = 1;

const int _WCHAR_T_DEFINED = 1;

const int NULL = 0;

const int _HAS_CXX17 = 0;

const int _HAS_CXX20 = 0;

const int _HAS_CXX23 = 0;

const int _HAS_CXX26 = 0;

const int _HAS_NODISCARD = 1;

const int INT8_MIN = -128;

const int INT16_MIN = -32768;

const int INT32_MIN = -2147483648;

const int INT64_MIN = -9223372036854775808;

const int INT8_MAX = 127;

const int INT16_MAX = 32767;

const int INT32_MAX = 2147483647;

const int INT64_MAX = 9223372036854775807;

const int UINT8_MAX = 255;

const int UINT16_MAX = 65535;

const int UINT32_MAX = 4294967295;

const int UINT64_MAX = -1;

const int INT_LEAST8_MIN = -128;

const int INT_LEAST16_MIN = -32768;

const int INT_LEAST32_MIN = -2147483648;

const int INT_LEAST64_MIN = -9223372036854775808;

const int INT_LEAST8_MAX = 127;

const int INT_LEAST16_MAX = 32767;

const int INT_LEAST32_MAX = 2147483647;

const int INT_LEAST64_MAX = 9223372036854775807;

const int UINT_LEAST8_MAX = 255;

const int UINT_LEAST16_MAX = 65535;

const int UINT_LEAST32_MAX = 4294967295;

const int UINT_LEAST64_MAX = -1;

const int INT_FAST8_MIN = -128;

const int INT_FAST16_MIN = -2147483648;

const int INT_FAST32_MIN = -2147483648;

const int INT_FAST64_MIN = -9223372036854775808;

const int INT_FAST8_MAX = 127;

const int INT_FAST16_MAX = 2147483647;

const int INT_FAST32_MAX = 2147483647;

const int INT_FAST64_MAX = 9223372036854775807;

const int UINT_FAST8_MAX = 255;

const int UINT_FAST16_MAX = 4294967295;

const int UINT_FAST32_MAX = 4294967295;

const int UINT_FAST64_MAX = -1;

const int INTPTR_MIN = -9223372036854775808;

const int INTPTR_MAX = 9223372036854775807;

const int UINTPTR_MAX = -1;

const int INTMAX_MIN = -9223372036854775808;

const int INTMAX_MAX = 9223372036854775807;

const int UINTMAX_MAX = -1;

const int PTRDIFF_MIN = -9223372036854775808;

const int PTRDIFF_MAX = 9223372036854775807;

const int SIZE_MAX = -1;

const int SIG_ATOMIC_MIN = -2147483648;

const int SIG_ATOMIC_MAX = 2147483647;

const int WCHAR_MIN = 0;

const int WCHAR_MAX = 65535;

const int WINT_MIN = 0;

const int WINT_MAX = 65535;

const int _ARM_WINAPI_PARTITION_DESKTOP_SDK_AVAILABLE = 1;

const int _CRT_BUILD_DESKTOP_APP = 1;

const int _UCRT_DISABLED_WARNINGS = 4324;

const int _ARGMAX = 100;

const int _TRUNCATE = -1;

const int _CRT_INT_MAX = 2147483647;

const int _CRT_SIZE_MAX = -1;

const String __FILEW__ = 'C';

const int _CRT_FUNCTIONS_REQUIRED = 1;

const int _CRT_HAS_CXX17 = 0;

const int _CRT_HAS_C11 = 0;

const int _CRT_INTERNAL_NONSTDC_NAMES = 1;

const int __STDC_SECURE_LIB__ = 200411;

const int __GOT_SECURE_LIB__ = 200411;

const int __STDC_WANT_SECURE_LIB__ = 1;

const int _SECURECRT_FILL_BUFFER_PATTERN = 254;

const int _CRT_SECURE_CPP_OVERLOAD_STANDARD_NAMES = 0;

const int _CRT_SECURE_CPP_OVERLOAD_STANDARD_NAMES_COUNT = 0;

const int _CRT_SECURE_CPP_OVERLOAD_SECURE_NAMES = 1;

const int _CRT_SECURE_CPP_OVERLOAD_STANDARD_NAMES_MEMORY = 0;

const int _CRT_SECURE_CPP_OVERLOAD_SECURE_NAMES_MEMORY = 0;

const int _STATIC_INLINE_UCRT_FUNCTIONS = 0;

const int SUCCESS = 0;

const int ERROR_NULL_POINTER = -1;

const int ERROR_INVALID_KEY_SIZE = -2;

const int ERROR_ENCRYPTION_FAILED = -3;

const int ERROR_DECRYPTION_FAILED = -4;

const int ERROR_INVALID_FORMAT = -5;

const int ERROR_ALLOCATION_FAILED = -6;

const int KEY_SIZE = 32;

const int NONCE_SIZE = 12;

const int MAC_SIZE = 16;

const int ERROR_FILE_NOT_FOUND = -7;

const int ERROR_PERMISSION_DENIED = -8;

const int ERROR_IO_FAILED = -9;

const int ERROR_CANCELLED = -10;

const int ERROR_INVALID_PATH = -11;

const int ERROR_DISK_FULL = -12;
